{"version":3,"sources":["node_modules/browser-pack/_prelude.js","3p/3p.js","3p/ampcontext-lib.js","3p/ampcontext.js","3p/iframe-messaging-client.js","3p/polyfills.js","src/3p-frame-messaging.js","src/event-helper-listen.js","src/json.js","src/log.js","src/mode-object.js","src/mode.js","src/observable.js","src/polyfills/math-sign.js","src/polyfills/object-assign.js","src/string.js","src/types.js","src/url-parse-query-string.js","src/utils/object.js","third_party/babel/custom-babel-helpers.js"],"names":[],"mappings":"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","file":"ampcontext-lib.js","sourceRoot":"/source/","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility functions for scripts running inside of a third\n * party iframe.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\n\n\nimport {dev, user} from '../src/log';\nimport {isArray} from '../src/types';\nimport {map} from '../src/utils/object';\nimport {rethrowAsync} from '../src/log';\n\n\n/** @typedef {function(!Window, !Object)}  */\nlet ThirdPartyFunctionDef;\n\n\n/**\n * @const {!Object<ThirdPartyFunctionDef>}\n * @visibleForTesting\n */\nexport const registrations = map();\n\n/** @type {number} */\nlet syncScriptLoads = 0;\n\n/**\n * @param {string} id The specific 3p integration.\n * @param {ThirdPartyFunctionDef} draw Function that draws the 3p integration.\n */\nexport function register(id, draw) {\n  dev().assert(!registrations[id], 'Double registration %s', id);\n  registrations[id] = draw;\n}\n\n/**\n * Execute the 3p integration with the given id.\n * @param {string} id\n * @param {!Window} win\n * @param {!Object} data\n */\nexport function run(id, win, data) {\n  const fn = registrations[id];\n  user().assert(fn, 'Unknown 3p: ' + id);\n  fn(win, data);\n}\n\n/**\n * Synchronously load the given script URL. Only use this if you need a sync\n * load. Otherwise use {@link loadScript}.\n * Supports taking a callback that will be called synchronously after the given\n * script was executed.\n * @param {!Window} win\n * @param {string} url\n * @param {function()=} opt_cb\n */\nexport function writeScript(win, url, opt_cb) {\n  /*eslint no-useless-concat: 0*/\n  win.document\n      .write('<' + 'script src=\"' + encodeURI(url) + '\"><' + '/script>');\n  if (opt_cb) {\n    executeAfterWriteScript(win, opt_cb);\n  }\n}\n\n/**\n * Asynchronously load the given script URL.\n * @param {!Window} win\n * @param {string} url\n * @param {function()=} opt_cb\n * @param {function()=} opt_errorCb\n */\nexport function loadScript(win, url, opt_cb, opt_errorCb) {\n  /** @const {!Element} */\n  const s = win.document.createElement('script');\n  s.src = url;\n  if (opt_cb) {\n    s.onload = opt_cb;\n  }\n  if (opt_errorCb) {\n    s.onerror = opt_errorCb;\n  }\n  win.document.body.appendChild(s);\n}\n\n/**\n * Call function in micro task or timeout as a fallback.\n * This is a lightweight helper, because we cannot guarantee that\n * Promises are available inside the 3p frame.\n * @param {!Window} win\n * @param {function()} fn\n */\nexport function nextTick(win, fn) {\n  const P = win.Promise;\n  if (P) {\n    P.resolve().then/*OK*/(fn);\n  } else {\n    win.setTimeout(fn, 0);\n  }\n}\n\n/**\n * Run the function after all currently waiting sync scripts have been\n * executed.\n * @param {!Window} win\n * @param {function()} fn\n */\nfunction executeAfterWriteScript(win, fn) {\n  const index = syncScriptLoads++;\n  win['__runScript' + index] = fn;\n  win.document.write('<' + 'script>__runScript' + index + '()<' + '/script>');\n}\n\n/**\n * Throws if the given src doesn't start with prefix(es).\n * @param {!Array<string>|string} prefix\n * @param {string} src\n */\nexport function validateSrcPrefix(prefix, src) {\n  if (!isArray(prefix)) {\n    prefix = [prefix];\n  }\n  if (src !== undefined) {\n    for (let p = 0; p <= prefix.length; p++) {\n      const protocolIndex = src.indexOf(prefix[p]);\n      if (protocolIndex == 0) {\n        return;\n      }\n    }\n  }\n  throw new Error('Invalid src ' + src);\n}\n\n/**\n * Throws if the given src doesn't contain the string\n * @param {string} string\n * @param {string} src\n */\nexport function validateSrcContains(string, src) {\n  if (src.indexOf(string) === -1) {\n    throw new Error('Invalid src ' + src);\n  }\n}\n\n/**\n * Utility function to perform a potentially asynchronous task\n * exactly once for all frames of a given type and the provide the respective\n * value to all frames.\n * @param {!Window} global Your window\n * @param {string} taskId Must be not conflict with any other global variable\n *     you use. Must be the same for all callers from all frames that want\n *     the same result.\n * @param {function(function(*))} work Function implementing the work that\n *     is to be done. Receives a second function that should be called with\n *     the result when the work is done.\n * @param {function(*)} cb Callback function that is called when the work is\n *     done. The first argument is the result.\n */\nexport function computeInMasterFrame(global, taskId, work, cb) {\n  const master = global.context.master;\n  let tasks = master.__ampMasterTasks;\n  if (!tasks) {\n    tasks = master.__ampMasterTasks = {};\n  }\n  let cbs = tasks[taskId];\n  if (!tasks[taskId]) {\n    cbs = tasks[taskId] = [];\n  }\n  cbs.push(cb);\n  if (!global.context.isMaster) {\n    return;  // Only do work in master.\n  }\n  work(result => {\n    for (let i = 0; i < cbs.length; i++) {\n      cbs[i].call(null, result);\n    }\n    tasks[taskId] = {\n      push(cb) {\n        cb(result);\n      },\n    };\n  });\n}\n\n/**\n * Validates given data. Throws an exception if the data does not\n * contains a mandatory field. If called with the optional param\n * opt_optionalFields, it also validates that the data contains no fields other\n * than mandatory and optional fields.\n *\n * Mandatory fields also accept a string Array as an item. All items in that\n * array are considered as alternatives to each other. So the validation checks\n * that the data contains exactly one of those alternatives.\n *\n * @param {!Object} data\n * @param {!Array<string|!Array<string>>} mandatoryFields\n * @param {Array<string>=} opt_optionalFields\n */\nexport function validateData(data, mandatoryFields, opt_optionalFields) {\n  let allowedFields = opt_optionalFields || [];\n  for (let i = 0; i < mandatoryFields.length; i++) {\n    const field = mandatoryFields[i];\n    if (Array.isArray(field)) {\n      validateExactlyOne(data, field);\n      allowedFields = allowedFields.concat(field);\n    } else {\n      user().assert(data[field],\n          'Missing attribute for %s: %s.', data.type, field);\n      allowedFields.push(field);\n    }\n  }\n  if (opt_optionalFields) {\n    validateAllowedFields(data, allowedFields);\n  }\n}\n\n/**\n * Throws an exception if data does not contains exactly one field\n * mentioned in the alternativeField array.\n * @param {!Object} data\n * @param {!Array<string>} alternativeFields\n */\nfunction validateExactlyOne(data, alternativeFields) {\n  let countFileds = 0;\n\n  for (let i = 0; i < alternativeFields.length; i++) {\n    const field = alternativeFields[i];\n    if (data[field]) {\n      countFileds += 1;\n    }\n  }\n\n  user().assert(countFileds === 1,\n      '%s must contain exactly one of attributes: %s.',\n      data.type,\n      alternativeFields.join(', '));\n}\n\n/**\n * Throws a non-interrupting exception if data contains a field not supported\n * by this embed type.\n * @param {!Object} data\n * @param {!Array<string>} allowedFields\n */\nfunction validateAllowedFields(data, allowedFields) {\n  const defaultAvailableFields = {\n    width: true,\n    height: true,\n    type: true,\n    referrer: true,\n    canonicalUrl: true,\n    pageViewId: true,\n    location: true,\n    mode: true,\n    consentNotificationId: true,\n    ampSlotIndex: true,\n  };\n\n  for (const field in data) {\n    if (!data.hasOwnProperty(field) || field in defaultAvailableFields) {\n      continue;\n    }\n    if (allowedFields.indexOf(field) < 0) {\n      // Throw in a timeout, because we do not want to interrupt execution,\n      // because that would make each removal an instant backward incompatible\n      // change.\n      rethrowAsync(new Error(`Unknown attribute for ${data.type}: ${field}.`));\n    }\n  }\n}\n\n/** @private {!Object<string, boolean>} */\nlet experimentToggles = {};\n\n/**\n * Returns true if an experiment is enabled.\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(experimentId) {\n  return !!experimentToggles[experimentId];\n}\n\n/**\n * Set experiment toggles.\n * @param {!Object<string, boolean>} toggles\n */\nexport function setExperimentToggles(toggles) {\n  experimentToggles = toggles;\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport './polyfills';\nimport {AmpContext} from './ampcontext.js';\nimport {initLogConstructor, setReportError} from '../src/log';\n\n\ninitLogConstructor();\n\n\n// TODO(alanorozco): Refactor src/error.reportError so it does not contain big\n// transitive dependencies and can be included here.\nsetReportError(() => {});\n\n\n/**\n *  If window.context does not exist, we must instantiate a replacement and\n *  assign it to window.context, to provide the creative with all the required\n *  functionality.\n */\ntry {\n  const windowContextCreated = new Event('amp-windowContextCreated');\n  window.context = new AmpContext(window);\n  // Allows for pre-existence, consider validating correct window.context lib instance?\n  window.dispatchEvent(windowContextCreated);\n} catch (err) {\n  // do nothing with error\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {dict} from '../src/utils/object';\nimport {dev} from '../src/log';\nimport {IframeMessagingClient} from './iframe-messaging-client';\nimport {MessageType} from '../src/3p-frame-messaging';\nimport {nextTick} from './3p';\nimport {tryParseJson} from '../src/json';\nimport {isObject} from '../src/types';\n\nexport class AbstractAmpContext {\n\n  /**\n   *  @param {!Window} win The window that the instance is built inside.\n   */\n  constructor(win) {\n    dev().assert(!this.isAbstractImplementation_(),\n        'Should not construct AbstractAmpContext instances directly');\n\n    /** @protected {!Window} */\n    this.win_ = win;\n\n    // This value is cached since it could be overwritten by the master frame\n    // check using a value of a different type.\n    /** @private {?string} */\n    this.cachedFrameName_ = this.win_.name || null;\n\n    /** @type {?string} */\n    this.embedType_ = null;\n\n    // ----------------------------------------------------\n    // Please keep public attributes alphabetically sorted.\n    // ----------------------------------------------------\n\n    /** @public {?string|undefined} */\n    this.canary = null;\n\n    /** @type {?string} */\n    this.canonicalUrl = null;\n\n    /** @type {?string} */\n    this.clientId = null;\n\n    /** @type {?string|undefined} */\n    this.container = null;\n\n    /** @type {?Object<String, *>} */\n    this.data = null;\n\n    /** @type {?boolean} */\n    this.hidden = null;\n\n    /** @type {?Object} */\n    this.initialLayoutRect = null;\n\n    /** @type {?Object} */\n    this.initialIntersection = null;\n\n    /** @type {?Location} */\n    this.location = null;\n\n    /** @type {?Object} */\n    this.mode = null;\n\n    /** @type {?string} */\n    this.pageViewId = null;\n\n    /** @type {?string} */\n    this.referrer = null;\n\n    /** @type {?string} */\n    this.sentinel = null;\n\n    /** @type {?string} */\n    this.sourceUrl = null;\n\n    /** @type {?number} */\n    this.startTime = null;\n\n    /** @type {?string} */\n    this.tagName = null;\n\n    this.findAndSetMetadata_();\n\n    /** @protected {!IframeMessagingClient} */\n    this.client_ = new IframeMessagingClient(win);\n    this.client_.setHostWindow(this.getHostWindow_());\n    this.client_.setSentinel(dev().assertString(this.sentinel));\n\n    this.listenForPageVisibility_();\n  }\n\n  /**\n   * @return {boolean}\n   * @protected\n   */\n  isAbstractImplementation_() {\n    return true;\n  }\n\n  /** Registers an general handler for page visibility. */\n  listenForPageVisibility_() {\n    this.client_.makeRequest(\n        MessageType.SEND_EMBED_STATE,\n        MessageType.EMBED_STATE,\n        data => {\n          this.hidden = data.pageHidden;\n          this.dispatchVisibilityChangeEvent_();\n        });\n  }\n\n  /**\n   * TODO(alanorozco): Deprecate native event mechanism.\n   * @private\n   */\n  dispatchVisibilityChangeEvent_() {\n    const event = this.win_.document.createEvent('Event');\n    event.data = {hidden: this.hidden};\n    event.initEvent('amp:visibilitychange', true, true);\n    this.win_.dispatchEvent(event);\n  }\n\n  /**\n   *  Listen to page visibility changes.\n   *  @param {function({hidden: boolean})} callback Function to call every time\n   *    we receive a page visibility message.\n   *  @returns {function()} that when called stops triggering the callback\n   *    every time we receive a page visibility message.\n   */\n  onPageVisibilityChange(callback) {\n    return this.client_.registerCallback(MessageType.EMBED_STATE, data => {\n      callback({hidden: data.pageHidden});\n    });\n  }\n\n  /**\n   *  Send message to runtime to start sending intersection messages.\n   *  @param {function(Array<Object>)} callback Function to call every time we\n   *    receive an intersection message.\n   *  @returns {function()} that when called stops triggering the callback\n   *    every time we receive an intersection message.\n   */\n  observeIntersection(callback) {\n    const unlisten = this.client_.makeRequest(\n        MessageType.SEND_INTERSECTIONS,\n        MessageType.INTERSECTION,\n        intersection => {\n          callback(intersection.changes);\n        });\n\n    // Call the callback with the value that was transmitted when the\n    // iframe was drawn. Called in nextTick, so that callers don't\n    // have to specially handle the sync case.\n    // TODO(lannka, #8562): Deprecate this behavior\n    nextTick(this.win_, () => {\n      callback([this.initialIntersection]);\n    });\n\n    return unlisten;\n  };\n\n  /**\n   *  Send message to runtime requesting to resize ad to height and width.\n   *    This is not guaranteed to succeed. All this does is make the request.\n   *  @param {number} width The new width for the ad we are requesting.\n   *  @param {number} height The new height for the ad we are requesting.\n   */\n  requestResize(width, height) {\n    this.client_.sendMessage(MessageType.EMBED_SIZE, dict({\n      'width': width,\n      'height': height,\n    }));\n  };\n\n  /**\n   *  Allows a creative to set the callback function for when the resize\n   *    request returns a success. The callback should be set before resizeAd\n   *    is ever called.\n   *  @param {function(number, number)} callback Function to call if the resize\n   *    request succeeds.\n   */\n  onResizeSuccess(callback) {\n    this.client_.registerCallback(MessageType.EMBED_SIZE_CHANGED, obj => {\n      callback(obj.requestedHeight, obj.requestedWidth); });\n  };\n\n  /**\n   *  Allows a creative to set the callback function for when the resize\n   *    request is denied. The callback should be set before resizeAd\n   *    is ever called.\n   *  @param {function(number, number)} callback Function to call if the resize\n   *    request is denied.\n   */\n  onResizeDenied(callback) {\n    this.client_.registerCallback(MessageType.EMBED_SIZE_DENIED, obj => {\n      callback(obj.requestedHeight, obj.requestedWidth);\n    });\n  };\n\n  /**\n   *  Takes the current name on the window, and attaches it to\n   *  the name of the iframe.\n   *  @param {HTMLIFrameElement} iframe The iframe we are adding the context to.\n   */\n  addContextToIframe(iframe) {\n    // TODO(alanorozco): consider the AMP_CONTEXT_DATA case\n    iframe.name = dev().assertString(this.cachedFrameName_);\n  }\n\n  /**\n   *  Notifies the parent document of no content available inside embed.\n   */\n  noContentAvailable() {\n    this.client_.sendMessage(MessageType.NO_CONTENT);\n  }\n\n  /**\n   *  Parse the metadata attributes from the name and add them to\n   *  the class instance.\n   *  @param {!Object|string} data\n   *  @private\n   */\n  setupMetadata_(data) {\n    const dataObject = dev().assert(\n        typeof data === 'string' ? tryParseJson(data) : data,\n        'Could not setup metadata.');\n\n    const context = dataObject._context || dataObject.attributes._context;\n\n    this.canary = context.canary;\n    this.canonicalUrl = context.canonicalUrl;\n    this.clientId = context.clientId;\n    this.container = context.container;\n    this.data = context.tagName;\n    this.hidden = context.hidden;\n    this.initialLayoutRect = context.initialLayoutRect;\n    this.initialIntersection = context.initialIntersection;\n    this.location = context.location;\n    this.mode = context.mode;\n    this.pageViewId = context.pageViewId;\n    this.referrer = context.referrer;\n    this.sentinel = context.sentinel;\n    this.sourceUrl = context.sourceUrl;\n    this.startTime = context.startTime;\n    this.tagName = context.tagName;\n\n    this.embedType_ = dataObject.type || null;\n  }\n\n  /**\n   *  Calculate the hostWindow\n   *  @private\n   */\n  getHostWindow_() {\n    const sentinelMatch = this.sentinel.match(/((\\d+)-\\d+)/);\n    dev().assert(sentinelMatch, 'Incorrect sentinel format');\n    const depth = Number(sentinelMatch[2]);\n    const ancestors = [];\n    for (let win = this.win_; win && win != win.parent; win = win.parent) {\n      // Add window keeping the top-most one at the front.\n      ancestors.push(win.parent);\n    }\n    return ancestors[(ancestors.length - 1) - depth];\n  }\n\n  /**\n   *  Checks to see if there is a window variable assigned with the\n   *  sentinel value, sets it, and returns true if so.\n   *  @private\n   */\n  findAndSetMetadata_() {\n    // If the context data is set on window, that means we don't need\n    // to check the name attribute as it has been bypassed.\n    // TODO(alanorozco): why the heck could AMP_CONTEXT_DATA be two different\n    // types? FIX THIS.\n    if (isObject(this.win_.sf_) && this.win_.sf_.cfg) {\n      this.setupMetadata_(/** @type {!string}*/(this.win_.sf_.cfg));\n    } else if (this.win_.AMP_CONTEXT_DATA) {\n      if (typeof this.win_.AMP_CONTEXT_DATA == 'string') {\n        this.sentinel = this.win_.AMP_CONTEXT_DATA;\n      } else if (isObject(this.win_.AMP_CONTEXT_DATA)) {\n        this.setupMetadata_(this.win_.AMP_CONTEXT_DATA);\n      }\n    } else {\n      this.setupMetadata_(this.win_.name);\n    }\n  }\n}\n\n\nexport class AmpContext extends AbstractAmpContext {\n  /** @return {boolean} */\n  isAbstractImplementation_() {\n    return false;\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {Observable} from '../src/observable';\nimport {map} from '../src/utils/object';\nimport {\n  listen,\n  serializeMessage,\n  deserializeMessage,\n} from '../src/3p-frame-messaging';\nimport {getMode} from '../src/mode';\nimport {dev} from '../src/log';\n\nexport class IframeMessagingClient {\n\n  /**\n   *  @param {!Window} win A window object.\n   */\n  constructor(win) {\n    /** @private {!Window} */\n    this.win_ = win;\n    /** @private {?string} */\n    this.rtvVersion_ = getMode().rtvVersion || null;\n    /** @private {!Window} */\n    this.hostWindow_ = win.parent;\n    /** @private {?string} */\n    this.sentinel_ = null;\n    /**\n     * Map messageType keys to observables to be fired when messages of that\n     * type are received.\n     * @private {!Object}\n     */\n    this.observableFor_ = map();\n    this.setupEventListener_();\n  }\n\n  /**\n   * Make an event listening request to the host window.\n   *\n   * @param {string} requestType The type of the request message.\n   * @param {string} responseType The type of the response message.\n   * @param {function(Object)} callback The callback function to call\n   *   when a message with type responseType is received.\n   */\n  makeRequest(requestType, responseType, callback) {\n    const unlisten = this.registerCallback(responseType, callback);\n    this.sendMessage(requestType);\n    return unlisten;\n  }\n\n  /**\n   * Register callback function for message with type messageType.\n   *   As it stands right now, only one callback can exist at a time.\n   *   All future calls will overwrite any previously registered\n   *   callbacks.\n   * @param {string} messageType The type of the message.\n   * @param {function(Object)} callback The callback function to call\n   *   when a message with type messageType is received.\n   */\n  registerCallback(messageType, callback) {\n    // NOTE : no validation done here. any callback can be register\n    // for any callback, and then if that message is received, this\n    // class *will execute* that callback\n    return this.getOrCreateObservableFor_(messageType).add(callback);\n  }\n\n  /**\n   *  Send a postMessage to Host Window\n   *  @param {string} type The type of message to send.\n   *  @param {JsonObject=} opt_payload The payload of message to send.\n   */\n  sendMessage(type, opt_payload) {\n    this.hostWindow_.postMessage/*OK*/(\n        serializeMessage(\n            type, dev().assertString(this.sentinel_),\n            opt_payload, this.rtvVersion_),\n        '*');\n  }\n\n  /**\n   * Sets up event listener for post messages of the desired type.\n   *   The actual implementation only uses a single event listener for all of\n   *   the different messages, and simply diverts the message to be handled\n   *   by different callbacks.\n   *   To add new messages to listen for, call registerCallback with the\n   *   messageType to listen for, and the callback function.\n   * @private\n   */\n  setupEventListener_() {\n    listen(this.win_, 'message', event => {\n      // Does it look a message from AMP?\n      if (event.source != this.hostWindow_) {\n        return;\n      }\n\n      const message = deserializeMessage(event.data);\n      if (!message || message['sentinel'] != this.sentinel_) {\n        return;\n      }\n\n      this.fireObservable_(message['type'], message);\n    });\n  }\n\n  /**\n   * @param {!Window} win\n   */\n  setHostWindow(win) {\n    this.hostWindow_ = win;\n  }\n\n  /**\n   * @param {string} sentinel\n   */\n  setSentinel(sentinel) {\n    this.sentinel_ = sentinel;\n  }\n\n  /**\n   * @param {string} messageType\n   * @return {!Observable<Object>}\n   */\n  getOrCreateObservableFor_(messageType) {\n    if (!(messageType in this.observableFor_)) {\n      this.observableFor_[messageType] = new Observable();\n    }\n    return this.observableFor_[messageType];\n  }\n\n  /**\n   * @param {string} messageType\n   * @param {Object} message\n   */\n  fireObservable_(messageType, message) {\n    if (messageType in this.observableFor_) {\n      this.observableFor_[messageType].fire(message);\n    }\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Loads all polyfills needed by the AMP 3p integration frame.\n */\n\n\n// This list should not get longer without a very good reason.\nimport '../third_party/babel/custom-babel-helpers';\nimport {install as installMathSign} from '../src/polyfills/math-sign';\nimport {install as installObjectAssign} from '../src/polyfills/object-assign';\n\ninstallMathSign(self);\ninstallObjectAssign(self);\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from './log';\nimport {dict} from './utils/object';\nimport {internalListenImplementation} from './event-helper-listen';\nimport {parseJson} from './json';\n\n\n/** @const */\nconst AMP_MESSAGE_PREFIX = 'amp-';\n\n\n/** @enum {string} */\nexport const MessageType = {\n  // For amp-ad\n  SEND_EMBED_STATE: 'send-embed-state',\n  EMBED_STATE: 'embed-state',\n  SEND_EMBED_CONTEXT: 'send-embed-context',\n  EMBED_CONTEXT: 'embed-context',\n  SEND_INTERSECTIONS: 'send-intersections',\n  INTERSECTION: 'intersection',\n  EMBED_SIZE: 'embed-size',\n  EMBED_SIZE_CHANGED: 'embed-size-changed',\n  EMBED_SIZE_DENIED: 'embed-size-denied',\n  NO_CONTENT: 'no-content',\n\n  // For the frame to be placed in full overlay mode for lightboxes\n  FULL_OVERLAY_FRAME: 'full-overlay-frame',\n  FULL_OVERLAY_FRAME_RESPONSE: 'full-overlay-frame-response',\n  CANCEL_FULL_OVERLAY_FRAME: 'cancel-full-overlay-frame',\n  CANCEL_FULL_OVERLAY_FRAME_RESPONSE: 'cancel-full-overlay-frame-response',\n\n  // For amp-inabox\n  SEND_POSITIONS: 'send-positions',\n  POSITION: 'position',\n};\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {boolean=} opt_capture\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_capture) {\n  return internalListenImplementation(\n      element, eventType, listener, opt_capture);\n}\n\n\n/**\n * Serialize an AMP post message. Output looks like:\n * 'amp-011481323099490{\"type\":\"position\",\"sentinel\":\"12345\",\"foo\":\"bar\"}'\n * @param {string} type\n * @param {string} sentinel\n * @param {JsonObject=} data\n * @param {?string=} rtvVersion\n * @returns {string}\n */\nexport function serializeMessage(type, sentinel, data = dict(),\n    rtvVersion = null) {\n  // TODO: consider wrap the data in a \"data\" field. { type, sentinal, data }\n  const message = data;\n  message['type'] = type;\n  message['sentinel'] = sentinel;\n  return AMP_MESSAGE_PREFIX + (rtvVersion || '') + JSON.stringify(message);\n}\n\n\n/**\n * Deserialize an AMP post message.\n * Returns null if it's not valid AMP message format.\n *\n * @param {*} message\n * @returns {?JsonObject|undefined}\n */\nexport function deserializeMessage(message) {\n  if (!isAmpMessage(message)) {\n    return null;\n  }\n  const startPos = message.indexOf('{');\n  dev().assert(startPos != -1, 'JSON missing in %s', message);\n  try {\n    return parseJson(message.substr(startPos));\n  } catch (e) {\n    dev().error('MESSAGING', 'Failed to parse message: ' + message, e);\n    return null;\n  }\n}\n\n\n/**\n *  Returns true if message looks like it is an AMP postMessage\n *  @param {*} message\n *  @return {!boolean}\n */\nexport function isAmpMessage(message) {\n  return (typeof message == 'string' &&\n      message.indexOf(AMP_MESSAGE_PREFIX) == 0 &&\n      message.indexOf('{') != -1);\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or `3p-frame-messaging`,\n * depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {boolean=} opt_capture\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(element, eventType, listener,\n    opt_capture) {\n  let localElement = element;\n  let localListener = listener;\n  /** @type {?Function}  */\n  let wrapped = event => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n  };\n  const capture = opt_capture || false;\n  localElement.addEventListener(eventType, wrapped, capture);\n  return () => {\n    if (localElement) {\n      localElement.removeEventListener(eventType, wrapped, capture);\n    }\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\nimport {isObject} from './types';\n\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {*} should be string|number|boolean\n */\nlet JSONScalarDef;\n\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {*} should be !Object<string, ?JSONValueDef>\n */\nlet JSONObjectDef;\n\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {*} should be !Array<?JSONValueDef>\n */\nlet JSONArrayDef;\n\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {*} should be !JSONScalarDef|!JSONObjectDef|!JSONArrayDef\n */\nlet JSONValueDef;\n\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = Object.create(null);\n  for (const k in obj) {\n    if (!hasOwnProperty(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object, the returned value will\n * be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (let i = 0; i < parts.length; i++) {\n    const part = parts[i];\n    if (!part) {\n      value = undefined;\n      break;\n    }\n    if (!isObject(value) ||\n            value[part] === undefined ||\n            !hasOwnProperty(value, part)) {\n      value = undefined;\n      break;\n    }\n    value = value[part];\n  }\n  return value;\n}\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {*} json JSON string to parse\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */(JSON.parse(/** @type {string} */ (json)));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {*} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject|undefined} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    if (opt_onFailed) {\n      opt_onFailed(e);\n    }\n    return undefined;\n  }\n}\n\n\n/**\n * @param {*} obj\n * @param {string} key\n * @return {boolean}\n */\nfunction hasOwnProperty(obj, key) {\n  if (obj == null || typeof obj != 'object') {\n    return false;\n  }\n  return Object.prototype.hasOwnProperty.call(\n      /** @type {!Object} */ (obj), key);\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\nimport {getModeObject} from './mode-object';\nimport {isEnumValue} from './types';\n\n\n/** @const Time when this JS loaded.  */\nconst start = Date.now();\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n\n/**\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n\n/**\n * @enum {number}\n * @private Visible for testing only.\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error.js to break cyclic\n * dependency.\n * @param {function(*, !Element=)|undefined} fn\n */\nexport function setReportError(fn) {\n  self.reportError = fn;\n}\n\n/**\n * Logging class.\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * @param {!Window} win\n   * @param {function(!./mode.ModeDef):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix) {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = (getMode().test && win.AMP_TEST_IFRAME) ? win.parent : win;\n\n    /** @private @const {function(!./mode.ModeDef):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.calcLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix || '';\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  calcLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    // Delegate to the specific resolver.\n    return this.levelFunc_(getModeObject());\n  }\n\n  /**\n   * @param {string} tag\n   * @param {string} level\n   * @param {!Array} messages\n   */\n  msg_(tag, level, messages) {\n    if (this.level_ != LogLevel.OFF) {\n      let fn = this.win.console.log;\n      if (level == 'ERROR') {\n        fn = this.win.console.error || fn;\n      } else if (level == 'INFO') {\n        fn = this.win.console.info || fn;\n      } else if (level == 'WARN') {\n        fn = this.win.console.warn || fn;\n      }\n      messages.unshift(Date.now() - start, '[' + tag + ']');\n      fn.apply(this.win.console, messages);\n    }\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.level_ != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  fine(tag, var_args) {\n    if (this.level_ >= LogLevel.FINE) {\n      this.msg_(tag, 'FINE', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  info(tag, var_args) {\n    if (this.level_ >= LogLevel.INFO) {\n      this.msg_(tag, 'INFO', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  warn(tag, var_args) {\n    if (this.level_ >= LogLevel.WARN) {\n      this.msg_(tag, 'WARN', Array.prototype.slice.call(arguments, 1));\n    }\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, var_args) {\n    if (this.level_ >= LogLevel.ERROR) {\n      this.msg_(tag, 'ERROR', Array.prototype.slice.call(arguments, 1));\n    } else {\n      const error = createErrorVargs.apply(null,\n          Array.prototype.slice.call(arguments, 1));\n      this.prepareError_(error);\n      return error;\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   * @return {!Error|undefined}\n   */\n  error(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // reportError is installed globally per window in the entry point.\n      self.reportError(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @template T\n   */\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  assert(shouldBeTrueish, opt_message, var_args) {\n    let firstElement;\n    if (!shouldBeTrueish) {\n      const message = opt_message || 'Assertion failed';\n      const splitMessage = message.split('%s');\n      const first = splitMessage.shift();\n      let formatted = first;\n      const messageArray = [];\n      pushIfNonEmpty(messageArray, first);\n      for (let i = 2; i < arguments.length; i++) {\n        const val = arguments[i];\n        if (val && val.tagName) {\n          firstElement = val;\n        }\n        const nextConstant = splitMessage.shift();\n        messageArray.push(val);\n        pushIfNonEmpty(messageArray, nextConstant.trim());\n        formatted += toString(val) + nextConstant;\n      }\n      const e = new Error(formatted);\n      e.fromAssert = true;\n      e.associatedElement = firstElement;\n      e.messageArray = messageArray;\n      this.prepareError_(e);\n      // reportError is installed globally per window in the entry point.\n      self.reportError(e);\n      throw e;\n    }\n    return shouldBeTrueish;\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @template T\n   */\n  /*eslint \"google-camelcase/google-camelcase\": 2*/\n  assertElement(shouldBeElement, opt_message) {\n    const shouldBeTrueish = shouldBeElement && shouldBeElement.nodeType == 1;\n    this.assert(shouldBeTrueish, (opt_message || 'Element expected') + ': %s',\n        shouldBeElement);\n    return /** @type {!Element} */ (shouldBeElement);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   */\n  /*eslint \"google-camelcase/google-camelcase\": 2*/\n  assertString(shouldBeString, opt_message) {\n    this.assert(typeof shouldBeString == 'string',\n        (opt_message || 'String expected') + ': %s', shouldBeString);\n    return /** @type {string} */ (shouldBeString);\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    this.assert(typeof shouldBeNumber == 'number',\n        (opt_message || 'Number expected') + ': %s', shouldBeNumber);\n    return /** @type {number} */ (shouldBeNumber);\n  }\n\n  /**\n   * Asserts and returns the enum value. If the enum doesn't contain such a value,\n   * the error is thrown.\n   *\n   * @param {!Object<T>} enumObj\n   * @param {string} s\n   * @param {string=} opt_enumName\n   * @return T\n   * @template T\n   */\n  /*eslint \"google-camelcase/google-camelcase\": 2*/\n  assertEnumValue(enumObj, s, opt_enumName) {\n    if (isEnumValue(enumObj, s)) {\n      return s;\n    }\n    this.assert(false,\n        'Unknown %s value: \"%s\"',\n        opt_enumName || 'enum', s);\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n}\n\n\n/**\n * @param {string|!Element} val\n * @return {string}\n */\nfunction toString(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (val && val.nodeType == 1) {\n    return val.tagName.toLowerCase() + (val.id ? '#' + val.id : '');\n  }\n  return /** @type {string} */ (val);\n}\n\n\n/**\n * @param {!Array} array\n * @param {*} val\n */\nfunction pushIfNonEmpty(array, val) {\n  if (val != '') {\n    array.push(val);\n  }\n}\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const message = error.message;\n  const test = String(Math.random());\n  error.message = test;\n\n  if (error.message === test) {\n    error.message = message;\n    return error;\n  }\n\n  const e = new Error(error.message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = error.stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @private\n */\nfunction createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (let i = 0; i < arguments.length; i++) {\n    const arg = arguments[i];\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // reportError is installed globally per window in the entry point.\n    self.reportError(error);\n    throw error;\n  });\n}\n\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log}}\n */\nself.log = (self.log || {\n  user: null,\n  dev: null,\n});\n\nconst logs = self.log;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?Function}\n */\nlet logConstructor = null;\n\n\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier\n  // than the binary that does call `initLogConstructor` (amp.js), the extension\n  // will throw an error as that extension will never be able to initialize\n  // the log instances and we also don't want it to call `initLogConstructor`\n  // either (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are\n  // ready for use (stored globally) after the main binary calls\n  // `initLogConstructor`.\n  dev();\n  user();\n}\n\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *\n * @return {!Log}\n */\nexport function user() {\n  if (logs.user) {\n    return logs.user;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.user = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (mode.development || logNum >= 1) {\n      return LogLevel.FINE;\n    }\n    return LogLevel.OFF;\n  }, USER_ERROR_SENTINEL);\n}\n\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped in\n * the PROD binary. However, `devLog().assert` result is preserved in either case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return logs.dev = new logConstructor(self, mode => {\n    const logNum = parseInt(mode.log, 10);\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  });\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMode} from './mode';\n\n/**\n * Provides info about the current app. This return value may be cached and\n * passed around as it will always be DCE'd.\n * @param {?Window=} opt_win\n * @return {!./mode.ModeDef}\n */\nexport function getModeObject(opt_win) {\n  return {\n    localDev: getMode(opt_win).localDev,\n    development: getMode(opt_win).development,\n    filter: getMode(opt_win).filter,\n    minified: getMode(opt_win).minified,\n    lite: getMode(opt_win).lite,\n    test: getMode(opt_win).test,\n    log: getMode(opt_win).log,\n    version: getMode(opt_win).version,\n    rtvVersion: getMode(opt_win).rtvVersion,\n  };\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {startsWith} from './string';\nimport {parseQueryString_} from './url-parse-query-string';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   filter: (string|undefined),\n *   minified: boolean,\n *   lite: boolean,\n *   test: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n * }}\n */\nexport let ModeDef;\n\n/** @type {string} */\nconst version = '$internalRuntimeVersion$';\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * A #querySelector query to see if we have any scripts with development paths.\n * @type {string}\n */\nconst developmentScriptQuery = 'script[src*=\"/dist/\"],script[src*=\"/base/\"]';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.AMP_MODE) {\n    return win.AMP_MODE;\n  }\n  return win.AMP_MODE = getMode_(win);\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // For 3p integration code\n  if (win.context && win.context.mode) {\n    return win.context.mode;\n  }\n\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_DEV is only replaced when the --fortesting flag is NOT used.\n  const IS_DEV = true;\n  const IS_MINIFIED = false;\n  const FORCE_LOCALDEV = !!(self.AMP_CONFIG && self.AMP_CONFIG.localDev);\n  const AMP_CONFIG_3P_FRAME_HOST = self.AMP_CONFIG &&\n      self.AMP_CONFIG.thirdPartyFrameHost;\n\n  const isLocalDev = IS_DEV && !!(win.location.hostname == 'localhost' ||\n      (FORCE_LOCALDEV && win.location.hostname == AMP_CONFIG_3P_FRAME_HOST) ||\n      (win.location.ancestorOrigins && win.location.ancestorOrigins[0] &&\n        startsWith(win.location.ancestorOrigins[0], 'http://localhost:'))) &&\n      // Filter out localhost running against a prod script.\n      // Because all allowed scripts are ours, we know that these can only\n      // occur during local dev.\n      (!win.document || !!win.document.querySelector(developmentScriptQuery));\n\n  const hashQuery = parseQueryString_(\n      // location.originalHash is set by the viewer when it removes the fragment\n      // from the URL.\n      win.location.originalHash || win.location.hash);\n\n  const searchQuery = parseQueryString_(win.location.search);\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win, isLocalDev);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `gulp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    // Triggers validation\n    development: !!(hashQuery['development'] == '1' ||\n        win.AMP_DEV_MODE),\n    examiner: hashQuery['development'] == '2',\n    // Allows filtering validation errors by error category. For the\n    // available categories, see ErrorCategory in validator/validator.proto.\n    filter: hashQuery['filter'],\n    minified: IS_MINIFIED,\n    // Whether document is in an amp-lite viewer. It signal that the user\n    // would prefer to use less bandwidth.\n    lite: searchQuery['amp_lite'] != undefined,\n    test: IS_DEV && !!(win.AMP_TEST || win.__karma__),\n    log: hashQuery['log'],\n    version,\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n */\nfunction getRtvVersion(win, isLocalDev) {\n  // If it's local dev then we won't actually have a full version so\n  // just use the version.\n  if (isLocalDev) {\n    return version;\n  }\n\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `$internalRuntimeVersion$` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether $internalRuntimeVersion$ should contain\n  // minor version.\n  return `01${version}`;\n}\n\n\n/**\n * @param {!Window} win\n * @param {boolean} isLocalDev\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win, isLocalDev) {\n  return getRtvVersion(win, isLocalDev);\n}\n\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n\n\n/**\n * This class helps to manage observers. Observers can be added, removed or\n * fired through and instance of this class.\n * @template TYPE\n */\nexport class Observable {\n\n  constructor() {\n    /** @type {?Array<function(TYPE)>} */\n    this.handlers_ = null;\n  }\n\n  /**\n   * Adds the observer to this instance.\n   * @param {function(TYPE)} handler Observer's handler.\n   * @return {!UnlistenDef}\n   */\n  add(handler) {\n    if (!this.handlers_) {\n      this.handlers_ = [];\n    }\n    this.handlers_.push(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  /**\n   * Removes the observer from this instance.\n   * @param {function(TYPE)} handler Observer's instance.\n   */\n  remove(handler) {\n    if (!this.handlers_) {\n      return;\n    }\n    const index = this.handlers_.indexOf(handler);\n    if (index > -1) {\n      this.handlers_.splice(index, 1);\n    }\n  }\n\n  /**\n   * Removes all observers.\n   */\n  removeAll() {\n    if (!this.handlers_) {\n      return;\n    }\n    this.handlers_.length = 0;\n  }\n\n  /**\n   * Fires an event. All observers are called.\n   * @param {TYPE=} opt_event\n   */\n  fire(opt_event) {\n    if (!this.handlers_) {\n      return;\n    }\n    const handlers = this.handlers_;\n    for (let i = 0; i < handlers.length; i++) {\n      const handler = handlers[i];\n      handler(opt_event);\n    }\n  }\n\n  /**\n   * Returns number of handlers. Mostly needed for tests.\n   * @return {number}\n   */\n  getHandlerCount() {\n    if (!this.handlers_) {\n      return 0;\n    }\n    return this.handlers_.length;\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Parses the number x and returns its sign. For positive x returns 1, for\n * negative, -1. For 0 and -0, returns 0 and -0 respectively. For any number\n * that parses to NaN, returns NaN.\n *\n * @param {number} x\n * @returns {number}\n */\nexport function sign(x) {\n  x = Number(x);\n\n  // If x is 0, -0, or NaN, return it.\n  if (!x) {\n    return x;\n  }\n\n  return x > 0 ? 1 : -1;\n};\n\n\n/**\n * Sets the Math.sign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Math.sign) {\n    win.Object.defineProperty(win.Math, 'sign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: sign,\n    });\n  }\n}\n","/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\n\n/**\n * Copies values of all enumerable own properties from one or more source\n * objects (provided as extended arguments to the function) to a target object.\n *\n * @param {!Object} target\n * @param {...Object} var_args\n * @returns {!Object}\n */\nexport function assign(target, var_args) {\n  if (target == null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1; i < arguments.length; i++) {\n    const source = arguments[i];\n    if (source != null) {\n      for (const key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n}\n\n\n/**\n * Sets the Object.assign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.assign) {\n    win.Object.defineProperty(win.Object, 'assign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: assign,\n    });\n  }\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes removed and character after to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.startsWith.\n * @param {string} string\n * @param {string} prefix\n * @return {boolean}\n */\nexport function startsWith(string, prefix) {\n  if (prefix.length > string.length) {\n    return false;\n  }\n  return string.lastIndexOf(prefix, 0) == 0;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {!function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst toString_ = Object.prototype.toString;\n\n/**\n * Returns the ECMA [[Class]] of a value\n * @param {*} value\n * @return {string}\n */\nfunction toString(value) {\n  return toString_.call(value);\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport function isArray(value) {\n  return Array.isArray(value);\n}\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  if (!arrayLike) {\n    return [];\n  }\n  const array = new Array(arrayLike.length);\n  for (let i = 0; i < arrayLike.length; i++) {\n    array[i] = arrayLike[i];\n  }\n  return array;\n}\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString(value) === '[object Object]';\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return (typeof value === 'number' && isFinite(value));\n}\n\n/**\n * Determines if value is of FormData type.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFormData(value) {\n  return toString(value) === '[object FormData]';\n}\n\n/**\n * Checks whether `s` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} s\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, s) {\n  for (const k in enumObj) {\n    if (enumObj[k] === s) {\n      return true;\n    }\n  }\n  return false;\n}\n","/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst regex = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * DO NOT import the function from this file. Instead, import parseQueryString\n * from `src/url.js`.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString_(queryString) {\n  const params = /** @type {!JsonObject} */ (Object.create(null));\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = regex.exec(queryString))) {\n    const name = decodeURIComponent(match[1]).trim();\n    const value = match[2] ? decodeURIComponent(match[2]).trim() : '';\n    params[name] = value;\n  }\n  return params;\n}\n","/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isObject} from '../types';\n\n/* @const */\nconst hasOwn_ = Object.prototype.hasOwnProperty;\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Returns a `map`, and will always return a at-dict like object.\n * The JsonObject type is just a simple object that is a dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  return /** @type {!JsonObject} */ (map(opt_initial));\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} maxDepth The maximum depth for deep merge, beyond which\n *    Object.assign will be used.\n * @return {!Object}\n * @throws {Error} if `source` contains a circular reference\n */\nfunction deepMerge_(target, source, maxDepth) {\n  // Keep track of seen objects to prevent infinite loops on objects with\n  // recursive references.\n  const seen = [];\n  // Traversal must be breadth-first so any object encountered for the first\n  // time does not have a reference  at a shallower depth. Otherwise, a\n  // circular reference found at depth == maxDepth could cause an unexpected\n  // change at a shallower depth if the same object exists at a shallower depth.\n  const queue = [{target, source, depth: 0}];\n  while (queue.length > 0) {\n    const {target, source, depth} = queue.shift();\n    if (seen.includes(source)) {\n      throw new Error('Source object contains circular references');\n    }\n    seen.push(source);\n    if (target === source) {\n      continue;\n    }\n    if (depth > maxDepth) {\n      Object.assign(target, source);\n      continue;\n    }\n    Object.keys(source).forEach(key => {\n      const newValue = source[key];\n      // Perform a deep merge IFF both a and b have the same property and\n      // the properties on both a and b are non-null plain objects.\n      if (hasOwn(target, key)) {\n        const oldValue = target[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({target: oldValue, source: newValue, depth: depth + 1});\n          return;\n        }\n      }\n      target[key] = newValue;\n    });\n  }\n  return target;\n}\n\n/**\n * Deep merge object b into object a. Both a and b should only contain\n * primitives, arrays, and plain objects. For any conflicts, object b wins.\n * Arrays are replaced, not merged. Plain objects are recursively merged.\n * @param {!Object} target\n * @param {!Object} source\n * @param {number=} opt_maxDepth The maximum depth for deep merge,\n *     beyond which Object.assign will be used.\n * @return {!Object}\n * @throws {Error} if `source` contains a circular reference\n */\nexport function deepMerge(target, source, opt_maxDepth) {\n  return deepMerge_(target, source, opt_maxDepth || Number.POSITIVE_INFINITY);\n}\n","(function (global) {\n  var babelHelpers = global.babelHelpers = {};\n\n  babelHelpers.inherits = function (subClass, superClass) {\n    if (typeof superClass !== \"function\" && superClass !== null) {\n      throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n    }\n\n    subClass.prototype = Object.create(superClass && superClass.prototype, {\n      constructor: {\n        value: subClass,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n  };\n\n  babelHelpers.createClass = (function () {\n    function defineProperties(target, props) {\n      for (var i = 0; i < props.length; i++) {\n        var descriptor = props[i];\n        descriptor.enumerable = descriptor.enumerable || false;\n        descriptor.configurable = true;\n        if (\"value\" in descriptor) descriptor.writable = true;\n        Object.defineProperty(target, descriptor.key, descriptor);\n      }\n    }\n\n    return function (Constructor, protoProps, staticProps) {\n      if (protoProps) defineProperties(Constructor.prototype, protoProps);\n      if (staticProps) defineProperties(Constructor, staticProps);\n      return Constructor;\n    };\n  })();\n\n  babelHelpers.slice = Array.prototype.slice;\n  babelHelpers.bind = Function.prototype.bind;\n\n  babelHelpers.interopRequireWildcard = function (obj) {\n    if (obj && obj.__esModule) {\n      return obj;\n    } else {\n      var newObj = {};\n\n      if (obj != null) {\n        for (var key in obj) {\n          if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];\n        }\n      }\n\n      newObj[\"default\"] = obj;\n      return newObj;\n    }\n  };\n\n  babelHelpers.interopRequireDefault = function (obj) {\n    return obj && obj.__esModule ? obj : { default: obj };\n  };\n\n  babelHelpers.get = function get(object, property, receiver) {\n    if (object === null) object = Function.prototype;\n    var desc = Object.getOwnPropertyDescriptor(object, property);\n\n    if (desc === undefined) {\n      var parent = Object.getPrototypeOf(object);\n\n      if (parent === null) {\n        return undefined;\n      } else {\n        return get(parent, property, receiver);\n      }\n    } else if (\"value\" in desc) {\n      return desc.value;\n    } else {\n      var getter = desc.get;\n\n      if (getter === undefined) {\n        return undefined;\n      }\n\n      return getter.call(receiver);\n    }\n  };\n\n  babelHelpers.classCallCheck = function (instance, Constructor) {\n    if (!(instance instanceof Constructor)) {\n      throw new TypeError(\"Cannot call a class as a function\");\n    }\n  };\n\n  babelHelpers.defineProperty = function(obj, key, value) {\n      obj[key] = value;\n      return obj;\n  };\n})(typeof global === \"undefined\" ? self : global);\n"]}