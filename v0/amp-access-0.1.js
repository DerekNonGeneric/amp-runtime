(self.AMP=self.AMP||[]).push({n:"amp-access",v:"123456789",f:(function(AMP){var h;var aa=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function k(a){var b=Object.create(null);if(!a)return b;for(var c;c=aa.exec(a);){var d=decodeURIComponent(c[1]).trim(),e=c[2]?decodeURIComponent(c[2]).trim():"";b[d]=e}return b};var ba="";
function ca(){var a,b=a||self,c;if(b.AMP_MODE)c=b.AMP_MODE;else{c=b;if(c.context&&c.context.mode)c=c.context.mode;else{var d=k(c.location.originalHash||c.location.hash),e=k(c.location.search);ba||(ba=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"01123456789");c={localDev:!1,development:!("1"!=d.development&&!c.AMP_DEV_MODE),examiner:"2"==d.development,filter:d.filter,minified:!0,lite:void 0!=e.amp_lite,test:!1,log:d.log,version:"123456789",rtvVersion:ba}}c=b.AMP_MODE=c}return c}
;var da=Object.prototype.toString;function ea(a){if(!a)return[];for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=a[c];return b};Date.now();self.log=self.log||{user:null,dev:null};var t=self.log;function y(){if(t.user)return t.user;throw Error("failed to call initLogConstructor");}function z(){if(t.dev)return t.dev;throw Error("failed to call initLogConstructor");};function fa(a){if("undefined"!==typeof TextDecoder)return(new TextDecoder("utf-8")).decode(a);var b=String.fromCharCode.apply(String,ea(new Uint8Array(a.buffer||a)));return decodeURIComponent(escape(b))}function ga(a){for(var b=new Uint8Array(a.length),c=0;c<a.length;c++){var d=a.charCodeAt(c);b[c]=d}return b};var A=self.AMP_CONFIG||{},ha=A.cdnUrl||"https://cdn.ampproject.org",ia=("string"==typeof A.cdnProxyRegex?new RegExp(A.cdnProxyRegex):A.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org/;var ja,ka,la=/[?&]amp_js[^&]*/;
function B(a){var b;ja||(ja=self.document.createElement("a"),ka=self.UrlCache||(self.UrlCache=Object.create(null)));var c=ka[a];if(c)return c;var d=ja;d.href=a;d.protocol||(d.href=d.href);var e={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname);if("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)e.port="",e.host=e.hostname;e.origin=
d.origin&&"null"!=d.origin?d.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href;var f=e,g=f;return b?g:ka[a]=g}function ma(a){var b=[],c;for(c in a){var d=a[c];if(null!=d)if(Array.isArray(d))for(var e=0;e<d.length;e++){var f=d[e];b.push(encodeURIComponent(c)+"="+encodeURIComponent(f))}else e=d,b.push(encodeURIComponent(c)+"="+encodeURIComponent(e))}return b.join("&")}
function na(a){"string"==typeof a&&(a=B(a));var b;(b="https:"==a.protocol||"localhost"==a.hostname)||(a=a.hostname,b=a.length-10,b=0<=b&&a.indexOf(".localhost",b)==b);return b}function H(a,b){var c;c=void 0===c?"source":c;y().assert(null!=a,"%s %s must be available",b,c);var d=a;y().assert(na(d)||/^(\/\/)/.test(d),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,d)}
function I(a){var b=a.indexOf("#");return-1==b?a:a.substring(0,b)}function J(a){"string"==typeof a&&(a=B(a));return ia.test(a.origin)}
function qa(a){"string"==typeof a&&(a=B(a));if(!J(a))return a.href;var b=a.pathname.split("/"),c=b[1];y().assert("a"==c||"c"==c||"v"==c,"Unknown path prefix in url %s",a.href);var d=b[2],e="s"==d?"https://"+decodeURIComponent(b[3]):"http://"+decodeURIComponent(d);y().assert(0<e.indexOf("."),"Expected a . in origin %s",e);b.splice(1,"s"==d?3:2);b=e+b.join("/");c=(c=a.search)&&"?"!=c?(c=c.replace(la,"").replace(/^[?&]/,""))?"?"+c:"":"";return b+c+(a.hash||"")};function ra(a){a=a.__AMP_TOP||a;return sa(a,"performance")?K(a,"performance"):null}function ta(a,b){if(a.nodeType){var c=(a.ownerDocument||a).defaultView;if(c=c!=(c.__AMP_TOP||c)&&sa(c,b)?K(c,b):null)return c}return N(a,b)}function O(a,b){a=a.__AMP_TOP||a;return K(a,b)}function N(a,b){a=ua(a);a=va(a);return K(a,b)}function wa(a,b){return xa(va(a),b)}function ya(a,b){return za(va(a),b)}function ua(a){return a.nodeType?O((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}
function va(a){a=ua(a);return a.isSingleDoc()?a.win:a}function K(a,b){sa(a,b);var c=Aa(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function xa(a,b){var c=za(a,b);if(c)return c;var d,e=new Promise(function(a){d=a});Aa(a)[b]={obj:null,promise:e,resolve:d,context:null,ctor:null};return e}function za(a,b){var c=Aa(a)[b];if(c){if(c.promise)return c.promise;K(a,b);return c.promise=Promise.resolve(c.obj)}return null}
function Aa(a){var b=a.services;b||(b=a.services={});return b}function sa(a,b){a=a.services&&a.services[b];return!(!a||!a.ctor&&!a.obj)};function Ba(a,b){if("."==b)return a;b=b.split(".");for(var c=0;c<b.length;c++){var d=b[c];if(!d){a=void 0;break}if("[object Object]"!==da.call(a)||void 0===a[d]||null==a||"object"!=typeof a||!Object.prototype.hasOwnProperty.call(a,d)){a=void 0;break}a=a[d]}return a}function Ca(a,b){try{return JSON.parse(a)}catch(c){b&&b(c)}};var P=null;Promise.resolve();
function Q(a,b){if(!P){P=Object.create(null);if(a.AMP_CONFIG)for(var c in a.AMP_CONFIG){var d=a.AMP_CONFIG[c];"number"===typeof d&&0<=d&&1>=d&&(P[c]=Math.random()<d)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(c=a.AMP_CONFIG["allow-doc-opt-in"],d=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]')))for(var d=d.getAttribute("content").split(","),e=0;e<d.length;e++)-1!=c.indexOf(d[e])&&(P[d[e]]=!0);Object.assign(P,Da(a));
if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length)for(c=a.AMP_CONFIG["allow-url-opt-in"],a=k(a.location.originalHash||a.location.hash),d=0;d<c.length;d++)e=a["e-"+c[d]],"1"==e&&(P[c[d]]=!0),"0"==e&&(P[c[d]]=!1)}a=P;var f=a;return!!f[b]}
function Da(a){a:{var b;b:{try{b=a.document.cookie;break b}catch(g){}b=void 0}if(a=b)for(a=a.split(";"),b=0;b<a.length;b++){var c=a[b].trim(),d=c.indexOf("=");if(-1!=d&&"AMP_EXP"==decodeURIComponent(c.substring(0,d).trim())){a=decodeURIComponent(c.substring(d+1).trim());break a}}a=null}var e=a,f=e?e.split(/\s*,\s*/g):[];a=Object.create(null);for(b=0;b<f.length;b++)0!=f[b].length&&("-"==f[b][0]?a[f[b].substr(1)]=!1:a[f[b]]=!0);return a};function Ea(a,b,c){var d;try{d=a.open(b,"_blank",c)}catch(e){z().error("DOM","Failed to open url on target: ","_blank",e)}d||(d=a.open(b,"_top"));return d};function Fa(a){return a.ampExtendedElements?!!a.ampExtendedElements["amp-analytics"]:!1}function Ga(a){return Ha(a,"cid",void 0).then(function(a){return y().assert(a,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.","cid","amp-analytics","amp-analytics","amp-analytics")})}
function Ha(a,b,c){var d=ua(a),e=ya(a,b);return e?e:Promise.resolve().then(function(){return!c&&Fa(d.win)?wa(a,b):d.whenBodyAvailable().then(function(){return c?ya(a,b):Fa(d.win)?wa(a,b):null})})};var Ia={"-":"+",_:"/",".":"="};function Ja(a){var b=atob(a.replace(/[-_.]/g,function(a){return Ia[a]}));return ga(b)};function Ka(a,b){var c="\n/*# sourceURL=/extensions/amp-access/0.1/amp-access.css*/",d=!1,e="amp-access",f=La(a,a.head,c,d||!1,e||null);if(Oa(a,f))b(f);else var g=setInterval(function(){Oa(a,f)&&(clearInterval(g),b(f))},4)}
function La(a,b,c,d,e){if(d&&b.runtimeStyleElement)return b.runtimeStyleElement;if(b.parentElement&&b.parentElement.hasAttribute("i-amphtml-layout")&&(d||e&&"amp-custom"!=e)){var f=d?b.querySelector("style[amp-runtime]"):b.querySelector("style[amp-extension="+e+"]");if(f)return d&&(b.runtimeStyleElement=f),f}a=a.createElement("style");a.textContent=c;var g=null;d?(a.setAttribute("amp-runtime",""),b.runtimeStyleElement=a):"amp-custom"==e?(a.setAttribute("amp-custom",""),g=b.lastChild):(a.setAttribute("amp-extension",
e||""),g=b.runtimeStyleElement);c=b;var l=g;l?l.nextSibling?c.insertBefore(a,l.nextSibling):c.appendChild(a):c.insertBefore(a,c.firstChild);return a}function Oa(a,b){var c=a.styleSheets;for(a=0;a<c.length;a++){var d=c[a];if(d.ownerNode==b)return!0}return!1};function Pa(a,b,c){function d(a){try{return g(a)}catch(m){throw self.reportError(m),m;}}var e=void 0,f=a,g=c,l=e||!1;f.addEventListener(b,d,l);return function(){f&&f.removeEventListener(b,d,l);d=f=g=null}};function Qa(a,b){return Pa(a,"message",b)}function Ra(a,b){var c=b,d=Pa(a,"click",function(a){try{c(a)}finally{c=null,d()}});return d};self.AMPErrors=self.AMPErrors||[];function R(a,b){var c;Ha(a,"amp-analytics-instrumentation").then(function(d){d&&d.triggerEventForTarget(a,b,c)})};function Sa(a){a=a.trim();a=a.replace(/^\-+BEGIN[^-]*\-+/,"");a=a.replace(/\-+END[^-]*\-+$/,"");a=a.replace(/[\r\n]/g,"").trim();return ga(atob(a))};/*

 Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 Code distributed by Google as part of the polymer project is also
 subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
*/
var Wa={strictStyling:!1,scopeRules:function(a,b,c){var d="";a&&Array.prototype.forEach.call(a,function(a){if(a.selectorText&&a.style&&void 0!==a.style.cssText)d+=this.scopeSelector(a.selectorText,b,this.strictStyling,c)+" {\n\t",d+=this.propertiesFromRule(a)+"\n}\n\n";else if(a.type===CSSRule.MEDIA_RULE)d+="@media "+a.media.mediaText+" {\n",d+=this.scopeRules(a.cssRules,b),d+="\n}\n\n";else try{a.cssText&&(d+=a.cssText+"\n\n")}catch(f){a.type===CSSRule.KEYFRAMES_RULE&&a.cssRules&&(d+=this.ieSafeCssTextFromKeyFrameRule(a))}},
this);return d},ieSafeCssTextFromKeyFrameRule:function(a){var b="@keyframes "+a.name+" {";Array.prototype.forEach.call(a.cssRules,function(a){b+=" "+a.keyText+" {"+a.style.cssText+"}"});return b+=" }"},scopeSelector:function(a,b,c,d){var e=[];a.split(",").forEach(function(a){a=a.trim();d&&(a=d(a));this.selectorNeedsScoping(a,b)&&(a=c&&!a.match(Ta)?this.applyStrictSelectorScope(a,b):this.applySelectorScope(a,b));e.push(a)},this);return e.join(", ")},selectorNeedsScoping:function(a,b){if(Array.isArray(b))return!0;
var c=this.makeScopeMatcher(b);return!a.match(c)},makeScopeMatcher:function(a){a=a.replace(/\[/g,"\\[").replace(/\]/g,"\\]");return new RegExp("^("+a+")"+Ua,"m")},applySelectorScope:function(a,b){return Array.isArray(b)?this.applySelectorScopeList(a,b):this.applySimpleSelectorScope(a,b)},applySelectorScopeList:function(a,b){for(var c=[],d=0,e;e=b[d];d++)c.push(this.applySimpleSelectorScope(a,e));return c.join(", ")},applySimpleSelectorScope:function(a,b){return a.match(Va)?(a=a.replace(Ta,b),a.replace(Va,
b+" ")):b+" "+a},applyStrictSelectorScope:function(a,b){b=b.replace(/\[is=([^\]]*)\]/g,"$1");var c=[" ",">","+","~"],d=a,e="["+b+"]";c.forEach(function(a){d=d.split(a).map(function(a){var b=a.trim().replace(Va,"");b&&0>c.indexOf(b)&&0>b.indexOf(e)&&(a=b.replace(/([^:]*)(:*)(.*)/,"$1"+e+"$2$3"));return a}).join(a)});return d},propertiesFromRule:function(a){var b=a.style.cssText;a.style.content&&!a.style.content.match(/['"]+|attr/)&&(b=b.replace(/content:[^;]*;/g,"content: '"+a.style.content+"';"));
a=a.style;for(var c in a)"initial"===a[c]&&(b+=c+": initial; ");return b}},Ua="([>\\s~+[.,{:][\\s\\S]*)?$",Ta="-shadowcsshost-no-combinator",Va=/-shadowcsshost/gim;var Xa;function Ya(a){return!!a&&-1!==a.toString().indexOf("[native code]")};var Za=/[^\.\-\_0-9a-zA-Z]/,$a=/[^\-\_0-9a-zA-Z]/;
function ab(a){var b=a.ownerDocument,c;void 0===Xa&&(Ya(self.document.registerElement)||Ya(self.Object.getOwnPropertyDescriptor(self,"customElements").get)?(c=Element,c=c.prototype.attachShadow?"v1":c.prototype.createShadowRoot?"v0":"none"):c="none",Xa=c);if("none"!=Xa)c="\n/*# sourceURL=/extensions/amp-access/0.1/amp-access.css*/";else{c=a.id;var d=a.ownerDocument,e=null;try{e=bb(d.implementation.createHTMLDocument(""))}catch(f){}if(!e)try{e=bb(d)}catch(f){}c=e?Wa.scopeRules.call(Wa,e,"#"+c,cb):
"\n/*# sourceURL=/extensions/amp-access/0.1/amp-access.css*/"}La(b,a,c,!1,"amp-access")}function cb(a){return a.replace(/(html|body)/g,db)}function db(a,b,c,d){var e=d.charAt(c-1),f=d.charAt(c+a.length);return e&&!Za.test(e)||f&&!$a.test(f)?a:"amp-"+a}
function bb(a){var b=a.createElement("style");b.textContent="\n/*# sourceURL=/extensions/amp-access/0.1/amp-access.css*/";try{return(a.head||a.documentElement).appendChild(b),b.sheet?b.sheet.cssRules:null}finally{b.parentNode&&b.parentNode.removeChild(b)}};var eb=function(){function a(a,b,c,d){c=c||{};for(d=a.length;d--;c[a[d]]=b);return c}function b(){this.yy={}}var c=[1,3],d=[1,4],e=[1,18],f=[1,13],g=[1,14],l=[1,15],q=[1,16],m=[1,17],U=[1,20],F=[1,21],p=[5,6,7,10],w=[5,6,7,10,15,16,17,18,19,20,21],L=[5,6,7,10,15,16,17,18,19,20,21,25],E={trace:function Tb(){},yy:{},Aa:{error:2,result:3,search_condition:4,EOF:5,OR:6,AND:7,NOT:8,"(":9,")":10,predicate:11,comparison_predicate:12,truthy_predicate:13,scalar_exp:14,EQ:15,DEQ:16,NEQ:17,LT:18,LTE:19,GT:20,
GTE:21,atom:22,field_ref:23,literal:24,DOT:25,field_name:26,NAME:27,STRING:28,NUMERIC:29,TRUE:30,FALSE:31,NULL:32,$accept:0,$end:1},L:{2:"error",5:"EOF",6:"OR",7:"AND",8:"NOT",9:"(",10:")",15:"EQ",16:"DEQ",17:"NEQ",18:"LT",19:"LTE",20:"GT",21:"GTE",25:"DOT",27:"NAME",28:"STRING",29:"NUMERIC",30:"TRUE",31:"FALSE",32:"NULL"},qa:[0,[3,2],[4,3],[4,3],[4,2],[4,3],[4,1],[11,1],[11,1],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[12,3],[13,1],[14,1],[14,1],[22,1],[23,3],[23,1],[26,1],[24,1],[24,1],[24,1],[24,
1],[24,1]],performAction:function Ub(a,b,c,d,e,f){var g=f.length-1;switch(e){case 1:return f[g-1];case 2:this.a=f[g-2]||f[g];break;case 3:this.a=f[g-2]&&f[g];break;case 4:this.a=!f[g];break;case 5:this.a=f[g-1];break;case 6:case 7:case 8:case 17:case 18:case 19:this.a=f[g];break;case 9:this.a=f[g-2]===f[g];break;case 10:throw Error('"==" is not allowed, use "="');case 11:this.a=f[g-2]!==f[g];break;case 12:this.a=typeof f[g-2]==typeof f[g]&&f[g-2]<f[g];break;case 13:this.a=typeof f[g-2]==typeof f[g]&&
f[g-2]<=f[g];break;case 14:this.a=typeof f[g-2]==typeof f[g]&&f[g-2]>f[g];break;case 15:this.a=typeof f[g-2]==typeof f[g]&&f[g-2]>=f[g];break;case 16:this.a=void 0!==f[g]&&null!==f[g]&&""!==f[g]&&0!==f[g]&&!1!==f[g];break;case 20:this.a="[object Object]"==Object.prototype.toString.call(f[g-2])&&f[g-2].hasOwnProperty(f[g])?f[g-2][f[g]]:null;break;case 21:this.a=void 0!==d[f[g]]?d[f[g]]:null;break;case 22:this.a=a;break;case 23:this.a=a.substring(1,a.length-1);break;case 24:this.a=Number(a);break;case 25:this.a=
!0;break;case 26:this.a=!1;break;case 27:this.a=null}},table:[{3:1,4:2,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{1:[3]},{5:[1,19],6:U,7:F},{4:22,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{4:23,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},a(p,[2,6]),a(p,[2,7]),a(p,[2,8]),a(p,[2,16],{15:[1,24],16:[1,25],17:[1,26],18:[1,27],19:[1,28],20:[1,29],21:[1,30]}),a(w,[2,17]),a(w,[2,18],{25:[1,
31]}),a(w,[2,19]),a(L,[2,21]),a(w,[2,23]),a(w,[2,24]),a(w,[2,25]),a(w,[2,26]),a(w,[2,27]),a(L,[2,22]),{1:[2,1]},{4:32,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{4:33,8:c,9:d,11:5,12:6,13:7,14:8,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},a(p,[2,4]),{6:U,7:F,10:[1,34]},{14:35,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{14:36,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{14:37,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},
{14:38,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{14:39,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{14:40,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{14:41,22:9,23:10,24:11,26:12,27:e,28:f,29:g,30:l,31:q,32:m},{26:42,27:e},a([5,6,10],[2,2],{7:F}),a(p,[2,3]),a(p,[2,5]),a(p,[2,9]),a(p,[2,10]),a(p,[2,11]),a(p,[2,12]),a(p,[2,13]),a(p,[2,14]),a(p,[2,15]),a(L,[2,20])],defaultActions:{19:[2,1]},parseError:function Vb(a,b){if(b.recoverable)this.trace(a);else throw Error(a);
},parse:function Wb(a){function b(a){d.length-=2*a;f.length-=a;g.length-=a}var c=this,d=[0],e=[],f=[null],g=[],l=this.table,q="",M=0,m=0,p=0,w=2,F=1,L=g.slice.call(arguments,1),n=Object.create(this.lexer),C={yy:{}},v;for(v in this.yy)Object.prototype.hasOwnProperty.call(this.yy,v)&&(C.yy[v]=this.yy[v]);n.setInput(a,C.yy);C.yy.lexer=n;C.yy.parser=this;"undefined"==typeof n.yylloc&&(n.yylloc={});var E=n.yylloc;g.push(E);var U=n.options&&n.options.ranges;this.parseError="function"===typeof C.yy.parseError?
C.yy.parseError:Object.getPrototypeOf(this).parseError;var pa=function(){var a;a=n.lex()||F;"number"!==typeof a&&(a=c.Aa[a]||a);return a};for(var r,oa,D,u,G={},V,x,Ma;;){D=d[d.length-1];if(this.defaultActions[D])u=this.defaultActions[D];else{if(null===r||"undefined"==typeof r)r=pa();u=l[D]&&l[D][r]}if("undefined"===typeof u||!u.length||!u[0]){var Na="";v=[];for(V in l[D])this.L[V]&&V>w&&v.push("'"+this.L[V]+"'");Na=n.showPosition?"Parse error on line "+(M+1)+":\n"+n.showPosition()+"\nExpecting "+
v.join(", ")+", got '"+(this.L[r]||r)+"'":"Parse error on line "+(M+1)+": Unexpected "+(r==F?"end of input":"'"+(this.L[r]||r)+"'");this.parseError(Na,{text:n.match,token:this.L[r]||r,line:n.yylineno,loc:E,expected:v})}if(u[0]instanceof Array&&1<u.length)throw Error("Parse Error: multiple actions possible at state: "+D+", token: "+r);switch(u[0]){case 1:d.push(r);f.push(n.yytext);g.push(n.yylloc);d.push(u[1]);r=null;oa?(r=oa,oa=null):(m=n.yyleng,q=n.yytext,M=n.yylineno,E=n.yylloc,0<p&&p--);break;
case 2:x=this.qa[u[1]][1];G.a=f[f.length-x];G.ha={first_line:g[g.length-(x||1)].first_line,last_line:g[g.length-1].last_line,first_column:g[g.length-(x||1)].first_column,last_column:g[g.length-1].last_column};U&&(G.ha.range=[g[g.length-(x||1)].range[0],g[g.length-1].range[1]]);v=this.performAction.apply(G,[q,m,M,C.yy,u[1],f,g].concat(L));if("undefined"!==typeof v)return v;x&&(d=d.slice(0,-2*x),f=f.slice(0,-1*x),g=g.slice(0,-1*x));d.push(this.qa[u[1]][0]);f.push(G.a);g.push(G.ha);Ma=l[d[d.length-2]][d[d.length-
1]];d.push(Ma);break;case 3:return!0}}}},pa=function(){return{EOF:1,parseError:function(a,b){if(this.yy.parser)this.yy.parser.parseError(a,b);else throw Error(a);},setInput:function(a,b){this.yy=b||this.yy||{};this._input=a;this._more=this._backtrack=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},
input:function(){var a=this._input[0];this.yytext+=a;this.yyleng++;this.offset++;this.match+=a;this.matched+=a;var b=a.match(/(?:\r\n?|\n).*/g);b?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return a},unput:function(a){var b=a.length,c=a.split(/(?:\r\n?|\n)/g);this._input=a+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-b);this.offset-=b;var d=this.match.split(/(?:\r\n?|\n)/g);this.match=
this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);c.length-1&&(this.yylineno-=c.length-1);a=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:c?(c.length===d.length?this.yylloc.first_column:0)+d[d.length-c.length].length-c[0].length:this.yylloc.first_column-b};this.options.ranges&&(this.yylloc.range=[a[0],a[0]+this.yyleng-b]);this.yyleng=this.yytext.length;return this},
more:function(){this._more=!0;return this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(a){this.unput(this.match.slice(a))},pastInput:function(){var a=this.matched.substr(0,this.matched.length-
this.match.length);return(20<a.length?"...":"")+a.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var a=this.match;20>a.length&&(a+=this._input.substr(0,20-a.length));return(a.substr(0,20)+(20<a.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var a=this.pastInput(),b=Array(a.length+1).join("-");return a+this.upcomingInput()+"\n"+b+"^"},test_match:function(a,b){var c,d;this.options.backtrack_lexer&&(d={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,
first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(d.yylloc.range=this.yylloc.range.slice(0)));if(c=a[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=c.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,
last_column:c?c[c.length-1].length-c[c.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+a[0].length};this.yytext+=a[0];this.match+=a[0];this.matches=a;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._backtrack=this._more=!1;this._input=this._input.slice(a[0].length);this.matched+=a[0];a=this.performAction.call(this,this.yy,this,b,this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);
if(a)return a;if(this._backtrack)for(var e in d)this[e]=d[e];return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var a,b,c;this._more||(this.match=this.yytext="");for(var d=this._currentRules(),e=0;e<d.length;e++)if((b=this._input.match(this.rules[d[e]]))&&(!a||b[0].length>a[0].length))if(a=b,c=e,this.options.backtrack_lexer){a=this.test_match(b,d[e]);if(!1!==a)return a;if(this._backtrack)a=!1;else return!1}else if(!this.options.flex)break;return a?(a=this.test_match(a,
d[c]),!1!==a?a:!1):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var a=this.next();return a?a:this.lex()},begin:function(a){this.conditionStack.push(a)},popState:function M(){return 0<this.conditionStack.length-1?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function Xb(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-
1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function Yb(a){a=this.conditionStack.length-1-Math.abs(a||0);return 0<=a?this.conditionStack[a]:"INITIAL"},pushState:function Zb(a){this.begin(a)},stateStackSize:function $b(){return this.conditionStack.length},options:{},performAction:function(a,b,c,d){var e=d;switch(c){case 1:return 7;case 2:return 6;case 3:return 8;case 4:return 32;case 5:return 30;case 6:return 30;case 7:return 31;
case 8:return 31;case 9:return 9;case 10:return 10;case 11:return"|";case 12:return 19;case 13:return 18;case 14:return 21;case 15:return 20;case 16:return 17;case 17:return 16;case 18:return 15;case 19:return 29;case 20:return 27;case 21:return 28;case 22:return 28;case 23:return 25;case 24:return"INVALID";case 25:return 5}},rules:[/^(?:\s+)/,/^(?:AND\b)/,/^(?:OR\b)/,/^(?:NOT\b)/,/^(?:NULL\b)/,/^(?:TRUE\b)/,/^(?:true\b)/,/^(?:FALSE\b)/,/^(?:false\b)/,/^(?:\()/,/^(?:\))/,/^(?:\|)/,/^(?:<=)/,/^(?:<)/,
/^(?:>=)/,/^(?:>)/,/^(?:!=)/,/^(?:==)/,/^(?:=)/,/^(?:[0-9]+(\.[0-9]+)?\b)/,/^(?:[a-zA-Z_][a-zA-Z0-9_]*)/,/^(?:'[^\']*')/,/^(?:"[^\"]*")/,/^(?:\.)/,/^(?:.)/,/^(?:$)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0}}}}();E.lexer=pa;b.prototype=E;E.Parser=b;return new b}();function S(a,b,c){this.ampdoc=a;this.j=c;this.M=y().assert(b.authorization,'"authorization" URL must be specified');H(this.M,'"authorization"');this.H=!b.noPingback;this.S=b.pingback;this.H&&(y().assert(this.S,'"pingback" URL must be specified'),H(this.S,'"pingback"'));c=b;c.authorizationTimeout?(c=c.authorizationTimeout,y().assert("number"==typeof c,'"authorizationTimeout" must be a number'),ca().development||(c=Math.min(c,3E3))):c=3E3;this.X=c;this.h=O(a.win,"xhr");this.g=O(a.win,"timer")}h=S.prototype;
h.getConfig=function(){return{authorizationUrl:this.M,pingbackEnabled:this.H,pingbackUrl:this.S,authorizationTimeout:this.X}};h.getAuthorizationUrl=function(){return this.M};h.isAuthorizationEnabled=function(){return!0};h.getAuthorizationTimeout=function(){return this.X};h.authorize=function(){var a=this,b=this.j.buildUrl(this.M,!1);return b.then(function(b){return a.g.timeoutPromise(a.X,a.h.fetchJson(b,{credentials:"include"})).then(function(a){return a.json()})})};h.isPingbackEnabled=function(){return this.H};
h.pingback=function(){var a=this;return this.j.buildUrl(this.S,!0).then(function(b){return a.h.sendSignal(b,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:""})})};function fb(a,b,c){this.ampdoc=a;this.j=c;this.W=b.authorizationFallbackResponse||null;this.l=J(a.win.location)}h=fb.prototype;h.getConfig=function(){return{authorizationResponse:this.W}};h.isAuthorizationEnabled=function(){return!!this.W&&!this.l};h.authorize=function(){return Promise.resolve(this.W)};h.isPingbackEnabled=function(){return!1};h.pingback=function(){return Promise.resolve()};function T(a){this.win=a;this.U=a.crypto&&(a.crypto.subtle||a.crypto.webkitSubtle)||null}T.prototype.decode=function(a){return gb(a).payload};T.prototype.isVerificationSupported=function(){return!!this.U};
T.prototype.decodeAndVerify=function(a,b){var c=this;if(!this.U)throw Error("Crypto is not supported on this platform");var d=new Promise(function(b){return b(gb(a))});return d.then(function(a){var d=a.header.alg;if(!d||"RS256"!=d)throw Error("Only alg=RS256 is supported");return hb(c,b).then(function(b){var d=Ja(a.sig);return c.U.verify({name:"RSASSA-PKCS1-v1_5"},b,d,ga(a.verifiable))}).then(function(b){if(b)return a.payload;throw Error("Signature verification failed");})})};
function gb(a){function b(){throw Error('Invalid token: "'+a+'"');}var c=a.split(".");3!=c.length&&b();var d=Ja(c[0]),e=Ja(c[1]);return{header:Ca(fa(d),b),payload:Ca(fa(e),b),verifiable:c[0]+"."+c[1],sig:c[2]}}function hb(a,b){return b.then(function(b){return a.U.importKey("spki",Sa(b),{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"])})};function ib(a,b,c){this.ampdoc=a;this.j=c;this.c=new S(a,b,c);this.b=N(a,"viewer");this.h=O(a.win,"xhr");this.g=O(a.win,"timer");this.B=O(a.win,"vsync");var d=a.getRootNode().querySelector('meta[name="i-amphtml-access-state"]');this.s=d?d.getAttribute("content"):null;var e=Q(a.win,"amp-access-server-jwt");this.l=J(a.win.location)||e;var f=e?this.b.getParam("serverAccessService"):null;this.da=f||I(a.win.location.href);this.I=b.publicKey||null;this.A=b.publicKeyUrl||null;y().assert(this.I||this.A,'"publicKey" or "publicKeyUrl" must be specified');
this.A&&H(this.A,'"publicKeyUrl"');this.I&&this.A&&y().warn("amp-access-server-jwt",'Both "publicKey" and "publicKeyUrl" specified. The "publicKeyUrl" will be ignored.');this.Z=new T(a.win)}h=ib.prototype;h.getConfig=function(){return{client:this.c.getConfig(),proxy:this.l,serverState:this.s,publicKey:this.I,publicKeyUrl:this.A}};h.isAuthorizationEnabled=function(){return!0};h.authorize=function(){return this.l&&this.s?jb(this):kb(this)};h.isPingbackEnabled=function(){return this.c.isPingbackEnabled()};
h.pingback=function(){return this.c.pingback()};
function lb(a){var b=a.j.buildUrl(a.c.getAuthorizationUrl(),!1).then(function(b){return a.g.timeoutPromise(3E3,a.h.fetchText(b,{credentials:"include"}))}).then(function(a){return a.text()}).then(function(b){var c=a.Z.decode(b);y().assert(c.amp_authdata,'"amp_authdata" must be present in JWT');return{encoded:b,jwt:c}});ca().development&&(a.Z.isVerificationSupported()?b=b.then(function(b){return a.Z.decodeAndVerify(b.encoded,mb(a)).then(function(){return b})}):y().warn("amp-access-server-jwt","Cannot verify signature on this browser since it doesn't support WebCrypto APIs"),
b=b.then(function(a){var b=a.jwt,c=Date.now(),f=b.exp;y().assert(f,'"exp" field must be specified');y().assert(1E3*parseFloat(f)>c,"token has expired: %s",f);b=b.aud;y().assert(b,'"aud" field must be specified');c=!1;if(Array.isArray(b))for(f=0;f<b.length;f++){if("ampproject.org"==b[f]){c=!0;break}}else c="ampproject.org"==b;y().assert(c,'"aud" must be "%s": %s',"ampproject.org",b);return a}));return b.catch(function(a){throw y().createError("JWT fetch or validation failed: ",a);})}
function mb(a){return a.I?Promise.resolve(a.I):a.h.fetchText(a.A).then(function(a){return a.text()})}function kb(a){return lb(a).then(function(a){return a.jwt.amp_authdata})}
function jb(a){return lb(a).then(function(b){var c=b.encoded,d=b.jwt.amp_authdata;b=ma({url:I(a.ampdoc.win.location.href),state:a.s,jwt:c});return a.g.timeoutPromise(3E3,a.h.fetchDocument(a.da,{method:"POST",body:b,headers:{"Content-Type":"application/x-www-form-urlencoded"},requireAmpResponseSourceOrigin:!1})).then(function(b){return a.ca(b)}).then(function(){return d})})}
h.ca=function(a){var b=this,c=a.querySelectorAll("[i-amphtml-access-id]");return this.B.mutatePromise(function(){for(var a=0;a<c.length;a++){var e=c[a],f=e.getAttribute("i-amphtml-access-id"),g=b.ampdoc.getRootNode().querySelector('[i-amphtml-access-id="'+f+'"]');g?g.parentElement.replaceChild(b.ampdoc.win.document.importNode(e,!0),g):z().warn("amp-access-server-jwt","Section not found: ",f)}})};function nb(a,b,c){this.ampdoc=a;this.j=c;this.c=new S(a,b,c);this.b=N(a,"viewer");this.h=O(a.win,"xhr");this.g=O(a.win,"timer");this.B=O(a.win,"vsync");this.s=(b=a.getRootNode().querySelector('meta[name="i-amphtml-access-state"]'))?b.getAttribute("content"):null;b=Q(a.win,"amp-access-server");this.l=J(a.win.location)||b;this.da=(b?this.b.getParam("serverAccessService"):null)||I(a.win.location.href)}h=nb.prototype;h.getConfig=function(){return{client:this.c.getConfig(),proxy:this.l,serverState:this.s}};
h.isAuthorizationEnabled=function(){return!0};
h.authorize=function(){var a=this;if(!this.l||!this.s)return this.c.authorize();var b=this.j.collectUrlVars(this.c.getAuthorizationUrl(),!1);return b.then(function(b){var c={},e;for(e in b)null!=b[e]&&(c[e]=String(b[e]));e={url:I(a.ampdoc.win.location.href),state:a.s,vars:c};return a.g.timeoutPromise(a.c.getAuthorizationTimeout(),a.h.fetchDocument(a.da,{method:"POST",body:"request="+encodeURIComponent(JSON.stringify(e)),headers:{"Content-Type":"application/x-www-form-urlencoded"},requireAmpResponseSourceOrigin:!1}))}).then(function(b){var c=
b.querySelector('script[id="amp-access-data"]').textContent,e=JSON.parse(c);return a.ca(b).then(function(){return e})})};h.isPingbackEnabled=function(){return this.c.isPingbackEnabled()};h.pingback=function(){return this.c.pingback()};
h.ca=function(a){var b=this,c=a.querySelectorAll("[i-amphtml-access-id]");return this.B.mutatePromise(function(){for(var a=0;a<c.length;a++){var e=c[a],f=e.getAttribute("i-amphtml-access-id"),g=b.ampdoc.getRootNode().querySelector('[i-amphtml-access-id="'+f+'"]');g?g.parentElement.replaceChild(b.ampdoc.win.document.importNode(e,!0),g):z().warn("amp-access-server","Section not found: ",f)}})};function ob(a,b){var c=this;this.ampdoc=a;this.fa=y().assert(b.vendor,'"vendor" name must be specified');this.Ca=b[this.fa];this.H=!b.noPingback;this.ta=new Promise(function(a){c.ga=a})}h=ob.prototype;h.getConfig=function(){return this.Ca};h.registerVendor=function(a,b){y().assert(this.ga,"Vendor has already been registered");y().assert(a==this.fa,'Vendor "%s" doesn\'t match the configured vendor "%s"',a,this.fa);this.ga(b);this.ga=void 0};h.isAuthorizationEnabled=function(){return!0};
h.authorize=function(){return this.ta.then(function(a){return a.authorize()})};h.isPingbackEnabled=function(){return this.H};h.pingback=function(){return this.ta.then(function(a){return a.pingback()})};function pb(a,b,c,d){this.ampdoc=a;this.b=b;this.o=c;if(this.ma=Q(a.win,"amp-access-signin")&&this.b.isEmbedded()&&"1"==this.b.getParam("signin")){this.V=!!d.acceptAccessToken;var e=this.b.getParam("signinService"),f=d.signinServices;f&&y().assert(Array.isArray(f),'"signinServices" must be an array');this.ra=f&&-1!=f.indexOf(e)}else this.ra=this.V=!1;this.C=null}h=pb.prototype;h.isEnabled=function(){return this.ma};h.start=function(){this.getAccessTokenPassive()};
h.getAccessTokenPassive=function(){if(!this.V)return null;this.C||(this.C=this.b.sendMessageAwaitResponse("getAccessTokenPassive",{origin:this.o}).then(function(a){return a}).catch(function(a){y().error("amp-access-signin","Failed to retrieve access token: ",a);return null}));return this.C};
h.postLoginResult=function(a){var b=this;if(!this.V)return null;var c=a.code;return c?this.b.sendMessageAwaitResponse("storeAccessToken",{origin:this.o,authorizationCode:c}).then(function(a){b.C=Promise.resolve(a);return a}).catch(function(a){y().error("amp-access-signin","Failed to retrieve access token: ",a);return null}):null};
h.requestSignIn=function(a){var b=this;return this.ra?this.b.sendMessageAwaitResponse("requestSignIn",{origin:this.o,url:a}).then(function(a){b.C=Promise.resolve(a);return""}):null};var qb=/RETURN_URL/;function rb(a,b){var c=N(a,"viewer"),d=parseInt(c.getParam("dialog"),10);return d?new sb(c,b):new W(a.win,c,b)}function tb(a,b){return rb(a,b).open()}function sb(a,b){this.viewer=a;this.urlOrPromise=b}sb.prototype.getLoginUrl=function(){return("string"==typeof this.urlOrPromise?Promise.resolve(this.urlOrPromise):this.urlOrPromise).then(function(a){return X(a,"RETURN_URL")})};
sb.prototype.open=function(){var a=this;return this.getLoginUrl().then(function(b){return a.viewer.sendMessageAwaitResponse("openDialog",{url:b})})};function W(a,b,c){this.win=a;this.viewer=b;this.urlOrPromise=c;this.P=this.w=this.F=this.f=this.ba=this.K=null}W.prototype.open=function(){var a=this;y().assert(!this.K,"Dialog already opened");return(new Promise(function(b,c){a.K=b;a.ba=c;ub(a)})).then(function(b){a.Y();return b},function(b){a.Y();throw b;})};
W.prototype.Y=function(){this.ba=this.K=null;if(this.f){try{this.f.close()}catch(a){}this.f=null}this.w&&(this.win.clearInterval(this.w),this.w=null);this.P&&(this.P(),this.P=null)};W.prototype.getLoginUrl=function(){var a=this;return("string"==typeof this.urlOrPromise?Promise.resolve(this.urlOrPromise):this.urlOrPromise).then(function(b){return X(b,vb(a))})};
function ub(a){var b=a.win.screen,c=Math.floor(Math.min(700,.9*b.width)),d=Math.floor(Math.min(450,.9*b.height)),e="height="+d+",width="+c+",left="+Math.floor((b.width-c)/2)+",top="+Math.floor((b.height-d)/2),b=e+",resizable=yes,scrollbars=yes",f=vb(a);a.F=null;"string"==typeof a.urlOrPromise?(c=X(a.urlOrPromise,f),a.f=Ea(a.win,c,b),a.f&&(a.F=Promise.resolve())):(a.f=Ea(a.win,"",b),a.f&&(a.F=a.urlOrPromise.then(function(b){b=X(b,f);a.f.location.replace(b)},function(a){throw Error("failed to resolve url: "+
a);})));a.F?a.F.then(function(){wb(a,f)},function(b){xb(a,null,b)}):xb(a,null,Error("failed to open dialog"))}function wb(a,b){var c=B(b).origin;a.w=a.win.setInterval(function(){a.f.closed&&(a.win.clearInterval(a.w),a.w=null,a.win.setTimeout(function(){xb(a,"")},3E3))},500);a.P=Qa(a.win,function(b){b.origin==c&&b.data&&"amp"==b.data.sentinel&&"result"==b.data.type&&(a.f&&a.f.postMessage({sentinel:"amp",type:"result-ack"},c),xb(a,b.data.result))})}function xb(a,b,c){a.K&&(c?a.ba(c):a.K(b),a.Y())}
function vb(a){var b,c=a.viewer.getResolvedViewerUrl();return ha+"/v0/amp-login-done-0.1.html?url="+encodeURIComponent(c)}function X(a,b){return qb.test(a)?a.replace(qb,encodeURIComponent(b)):a+(-1==a.indexOf("?")?"?":"&")+"return="+encodeURIComponent(b)};var yb={CLIENT:"client",SERVER:"server",VENDOR:"vendor",OTHER:"other"};
function zb(a){var b=this;this.ampdoc=a;if(a.isSingleDoc()){var c=a.getRootNode();Ka(c,function(){})}else c=a.getRootNode(),ab(c);var d=a.getElementById("amp-access");if(this.G=!!d)this.na=Q(a.win,"amp-access-server"),this.xa=Q(a.win,"amp-access-jwt"),this.ia=d,c=Ca(this.ia.textContent,function(a){throw y().createError('Failed to parse "amp-access" JSON: '+a);}),this.ea=Ab(this,c),this.O=Bb(c),this.ja=c.authorizationFallbackResponse,this.u=Cb(this,c),this.o=B(qa(a.win.location)).origin,this.g=O(a.win,
"timer"),this.B=O(a.win,"vsync"),this.sa=ta(a,"url-replace"),this.ua=Ga(a),this.b=N(a,"viewer"),this.Da=N(a,"viewport"),this.Ba=O(a.win,"templates"),this.za=N(a,"resources"),this.R=ra(a.win),this.ya=tb.bind(null,a),this.D=this.aa=null,this.T=new pb(a,this.b,this.o,c),this.$=this.N=new Promise(function(a){b.la=a}),this.J=null,this.pa={},this.m=null,this.oa=0,this.N.then(function(){R(Y(b),"access-authorization-received");b.R&&(b.R.tick("aaa"),b.R.tickSinceVisible("aaav"),b.R.flush())})}h=zb.prototype;
h.registerVendor=function(a,b){y().assert("vendor"==this.ea,'Acccess vendor "%s" can only be used for "type=vendor"',a);var c=this.u;c.registerVendor(a,b)};
function Cb(a,b){var c={buildUrl:a.buildUrl.bind(a),collectUrlVars:a.va.bind(a)},d=a.xa&&!0===b.jwt;switch(a.ea){case "client":return d?new ib(a.ampdoc,b,c):new S(a.ampdoc,b,c);case "server":return d?new ib(a.ampdoc,b,c):new nb(a.ampdoc,b,c);case "vendor":return new ob(a.ampdoc,b);case "other":return new fb(a.ampdoc,b,c)}throw z().createError("Unsupported access type: ",a.ea);}h.getAdapterConfig=function(){return this.u.getConfig()};
function Ab(a,b){var c=b.type?y().assertEnumValue(yb,b.type,"access type"):null;c||(c=b.vendor?"vendor":"client");"server"!=c||a.na||(y().warn("amp-access",'Experiment "amp-access-server" is not enabled.'),c="client");"client"==c&&a.na&&(y().info("amp-access","Forcing access type: SERVER"),c="server");return c}
function Bb(a){var b=a.login,c={};if(b)if("string"==typeof b)c[""]=b;else if("[object Object]"===da.call(b))for(var d in b)c[d]=b[d];else y().assert(!1,'"login" must be either a single URL or a map of URLs');for(var e in c)H(c[e]);return c}h.isEnabled=function(){return this.G};function Y(a){a=a.ampdoc.getRootNode();return a.documentElement||a.body||a}function Db(a){a.b.onBroadcast(function(b){"amp-access-reauthorize"==b.type&&b.origin==a.o&&Eb(a)})}
h.ka=function(){this.b.broadcast({type:"amp-access-reauthorize",origin:this.o})};function Fb(a){if(!a.aa){var b=Promise.resolve();a.aa=a.ua.then(function(a){return a.get({scope:"amp-access",createCookieIfNotPresent:!0},b)})}return a.aa}h.buildUrl=function(a,b){var c=this;return Gb(this,b).then(function(b){return c.sa.expandAsync(a,b)})};h.va=function(a,b){var c=this;return Gb(this,b).then(function(b){return c.sa.collectVars(a,b)})};
function Gb(a,b){return Fb(a).then(function(c){var d={READER_ID:c,ACCESS_READER_ID:c,ACCESS_TOKEN:function(){return a.T.getAccessTokenPassive()}};b&&(d.AUTHDATA=function(b){if(a.D)return Ba(a.D,b)});return d})}
function Eb(a,b){if(!a.u.isAuthorizationEnabled())return a.la(),Promise.resolve();Z(a,"amp-access-loading",!0);var c=a.b.whenFirstVisible(),d=c.then(function(){return a.u.authorize()}).catch(function(c){R(Y(a),"access-authorization-failed");if(a.ja&&!b)return y().error("amp-access","Authorization failed: ",c),a.ja;throw c;}),e=d.then(function(b){a.D=b;a.la();Z(a,"amp-access-loading",!1);Z(a,"amp-access-error",!1);Hb(a);return a.ampdoc.whenReady().then(function(){for(var c=a.ampdoc.getRootNode().querySelectorAll("[amp-access]"),
d=[],e=0;e<c.length;e++)d.push(Ib(a,c[e],b));return Promise.all(d)})}).catch(function(b){y().error("amp-access","Authorization failed: ",b);Z(a,"amp-access-loading",!1);Z(a,"amp-access-error",!0)});a.$=Promise.all([a.N,e]);return e}h.getAccessReaderId=function(){return this.G?Fb(this):null};h.getAuthdataField=function(a){var b=this;return this.G?this.$.then(function(){if(!b.D)return null;var c=Ba(b.D,a);return void 0!==c?c:null}):null};h.whenFirstAuthorized=function(){return this.N};
function Ib(a,b,c){var d=b.getAttribute("amp-access"),e;a:{try{eb.yy=c;e=!!eb.parse(d);break a}finally{eb.yy=null}e=void 0}var f=e,g=null;f&&(g=Jb(a,b,c));return g?g.then(function(){return Kb(a,b,f)}):Kb(a,b,f)}function Kb(a,b,c){var d=!b.hasAttribute("amp-access-hide");return c==d?Promise.resolve():a.za.mutateElement(b,function(){c?b.removeAttribute("amp-access-hide"):b.setAttribute("amp-access-hide","")})}
function Jb(a,b,c){var d=[],e=b.querySelectorAll("[amp-access-template]");if(0<e.length)for(var f={i:0};f.i<e.length;f={i:f.i},f.i++){var g=Lb(a,e[f.i],c).catch(function(a){return function(c){z().error("amp-access","Template failed: ",c,e[a.i],b)}}(f));d.push(g)}return 0<d.length?Promise.all(d):null}
function Lb(a,b,c){var d=b,e=null;"TEMPLATE"!=d.tagName&&(e=d,d=e.__AMP_ACCESS__TEMPLATE);if(!d)return Promise.reject(Error("template not found"));var f=a.Ba.renderTemplate(d,c);return f.then(function(b){return a.B.mutatePromise(function(){b.setAttribute("amp-access-template","");b.__AMP_ACCESS__TEMPLATE=d;d.parentElement?d.parentElement.replaceChild(b,d):e&&e.parentElement&&e.parentElement.replaceChild(b,e)})})}
function Mb(a,b){a.u.isPingbackEnabled()&&(a.J=null,a.ampdoc.whenReady().then(function(){a.b.isVisible()&&Nb(a,b);a.b.onVisibilityChanged(function(){a.b.isVisible()&&Nb(a,b)})}))}function Nb(a,b){a.J||(a.J=Ob(a,b).then(function(){return a.$}).then(function(){R(Y(a),"access-viewed");return Pb(a)}).catch(function(b){a.J=null;throw b;}),a.J.then(a.ka.bind(a)))}
function Ob(a,b){if(0==b)return Promise.resolve();var c=[];return(new Promise(function(d,e){c.push(a.b.onVisibilityChanged(function(){a.b.isVisible()||e(Error("CANCELLED"))}));var f=a.g.delay(d,b);c.push(function(){return a.g.cancel(f)});c.push(a.Da.onScroll(d));c.push(Ra(a.ampdoc.getRootNode(),d))})).then(function(){c.forEach(function(a){return a()})},function(a){c.forEach(function(a){return a()});throw a;})}
function Pb(a){return a.u.pingback().then(function(){R(Y(a),"access-pingback-sent")}).catch(function(b){R(Y(a),"access-pingback-failed");throw y().createError("Pingback failed: ",b);})}function Z(a,b,c){a.B.mutate(function(){Y(a).classList.toggle(b,c)})}h.wa=function(a){if("login"==a.method)a.event&&a.event.preventDefault(),Qb(this,"");else{var b=a.method;if(6>b.length?0:0==b.lastIndexOf("login-",0))a.event&&a.event.preventDefault(),Qb(this,a.method.substring(6))}};
h.getLoginUrl=function(a){return rb(this.ampdoc,a).getLoginUrl()};function Qb(a,b){y().assert(a.O[b],"Login URL is not configured: %s",b);var c=y().assert(a.pa[b],"Login URL is not ready: %s",b);Rb(a,c,b)}h.loginWithUrl=function(a,b){b=void 0===b?"":b;return Rb(this,a,b)};
function Rb(a,b,c){var d=Date.now();if(a.m&&1E3>d-a.oa)return a.m;Sb(a,c,"started");var e=a.T.requestSignIn(b)||a.ya(b),f=e.then(function(b){a.m=null;b=k(b);var d=b.success,e="true"==d||"yes"==d||"1"==d;e?Sb(a,c,"success"):Sb(a,c,"rejected");var f=a.T.postLoginResult(b)||Promise.resolve();if(e||!d)return f.then(function(){a.ka();return Eb(a,!0).then(function(){Mb(a,0)})})}).catch(function(b){Sb(a,c,"failed");a.m==f&&(a.m=null);throw b;});a.m=f;a.oa=d;return a.m}
function Sb(a,b,c){var d="access-login-"+c;R(Y(a),d);b&&(b="access-login-"+b+"-"+c,R(Y(a),b))}function Hb(a){if(0!=Object.keys(a.O).length){var b=[],c={},d;for(d in a.O)c.k=d,b.push(a.buildUrl(a.O[c.k],!0).then(function(b){return function(c){a.pa[b.k]=c;return{type:b.k,url:c}}}(c))),c={k:c.k};Promise.all(b)}}
(function(a){a.registerServiceForDoc("access",void 0,function(a){a=new zb(a);a.G?(ta(a.ampdoc,"action").installActionHandler(a.ia,a.wa.bind(a)),Hb(a),a.T.start(),Eb(a),Mb(a,2E3),Db(a)):y().info("amp-access",'Access is disabled - no "id=amp-access" element');return a})})(self.AMP);
})});
//# sourceMappingURL=amp-access-0.1.js.map

