(self.AMP=self.AMP||[]).push({n:"amp-auto-ads",v:"123456789",f:(function(AMP){function g(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]};var m=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;var n=Object.prototype.toString;Date.now();self.log=self.log||{user:null,dev:null};var p=self.log;function q(){if(p.user)return p.user;throw Error("failed to call initLogConstructor");};var r,t;function u(a,b){a=a.__AMP_TOP||a;return v(a,b)}function w(a,b){a=x(a);a=x(a);a=a.isSingleDoc()?a.win:a;return v(a,b)}function x(a){return a.nodeType?u((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function v(a,b){var c=a.services;c||(c=a.services={});var d=c;a=d[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj};var y=null;Promise.resolve();
function z(a,b){var c;if(!y){y=Object.create(null);if(a.AMP_CONFIG)for(c in a.AMP_CONFIG){var d=a.AMP_CONFIG[c];"number"===typeof d&&0<=d&&1>=d&&(y[c]=Math.random()<d)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(c=a.AMP_CONFIG["allow-doc-opt-in"],d=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]')))for(var d=d.getAttribute("content").split(","),e=0;e<d.length;e++)-1!=c.indexOf(d[e])&&(y[d[e]]=!0);Object.assign(y,
A(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){c=a.AMP_CONFIG["allow-url-opt-in"];d=a.location.originalHash||a.location.hash;a=Object.create(null);if(d)for(var f;f=m.exec(d);)e=decodeURIComponent(f[1]).trim(),f=f[2]?decodeURIComponent(f[2]).trim():"",a[e]=f;for(d=0;d<c.length;d++)e=a["e-"+c[d]],"1"==e&&(y[c[d]]=!0),"0"==e&&(y[c[d]]=!1)}}c=y;var h=c;return!!h[b]}
function A(a){a:{var b;b:{try{b=a.document.cookie;break b}catch(h){}b=void 0}if(a=b)for(a=a.split(";"),b=0;b<a.length;b++){var c=a[b].trim(),d=c.indexOf("=");if(-1!=d&&"AMP_EXP"==decodeURIComponent(c.substring(0,d).trim())){a=decodeURIComponent(c.substring(d+1).trim());break a}}a=null}var e=a,f=e?e.split(/\s*,\s*/g):[];a=Object.create(null);for(b=0;b<f.length;b++)0!=f[b].length&&("-"==f[b][0]?a[f[b].substr(1)]=!1:a[f[b]]=!0);return a};function B(a,b){for(var c,d=a;d&&d!==c;d=d.parentElement)if(b(d))return d;return null}function D(a,b){if(a.closest)return a.closest(b);b=b.toUpperCase();return B(a,function(a){return a.tagName==b})}var E;function F(a,b){if(null==E)try{a.ownerDocument.querySelector(":scope"),E=!0}catch(c){E=!1}if(E)return a.querySelectorAll(":scope "+b);a.classList.add("i-amphtml-scoped");b=a.querySelectorAll(".i-amphtml-scoped "+b);a.classList.remove("i-amphtml-scoped");return b};var G={isTrafficEligible:function(a){return!!a.document.querySelector("AMP-AUTO-ADS")},branches:["3782001","3782002"]};function H(a){this.g=a}
H.prototype.isEnabled=function(a){var b={"amp-auto-ads-adsense-holdout":G};a.experimentBranches=a.experimentBranches||{};for(var c in b)if(b.hasOwnProperty(c)&&!a.experimentBranches.hasOwnProperty(c))if(b[c].isTrafficEligible&&b[c].isTrafficEligible(a)){if(!a.experimentBranches[c]&&z(a,c)){var d=b[c].branches;a.experimentBranches[c]=d[Math.floor(Math.random()*d.length)]||null}}else a.experimentBranches[c]=null;var e=a.experimentBranches["amp-auto-ads-adsense-holdout"]||null;return"3782001"!=e};
H.prototype.getConfigUrl=function(){var a=w(this.g,"documentInfo").get(),b;b=a.canonicalUrl;r||(r=self.document.createElement("a"),t=self.UrlCache||(self.UrlCache=Object.create(null)));var c=t[b];if(c)b=c;else{c=r;c.href=b;c.protocol||(c.href=c.href);var d={href:c.href,protocol:c.protocol,host:c.host,hostname:c.hostname,port:"0"==c.port?"":c.port,pathname:c.pathname,search:c.search,hash:c.hash,origin:null};"/"!==d.pathname[0]&&(d.pathname="/"+d.pathname);if("http:"==d.protocol&&80==d.port||"https:"==
d.protocol&&443==d.port)d.port="",d.host=d.hostname;d.origin=c.origin&&"null"!=c.origin?c.origin:"data:"!=d.protocol&&d.host?d.protocol+"//"+d.host:d.href;b=t[b]=d}var e=b.hostname,c={client:this.g.getAttribute("data-ad-client"),plah:e,ama_t:"amp"};b=[];for(var d=4051,f=Object.keys(c),h=0;h<f.length;h++){var k=f[h],l=c[k];if(null!=l&&""!==l){var k=encodeURIComponent(k)+"=",l=encodeURIComponent(String(l)),C=k.length+l.length+1;if(C>d){(c=l.substr(0,d-k.length-1).replace(/%\w?$/,""))&&b.push(k+c);break}b.push(k+
l);d-=C}}return b.length?"//pagead2.googlesyndication.com/getconfig/ama?"+b.join("&"):"//pagead2.googlesyndication.com/getconfig/ama"};H.prototype.getAttributes=function(){return{type:"adsense","data-ad-client":this.g.getAttribute("data-ad-client")}};H.prototype.getAdConstraints=function(){var a=w(this.g,"viewport").getSize().height;return{initialMinSpacing:a,subsequentMinSpacing:[{adCount:3,spacing:2*a},{adCount:6,spacing:3*a}],maxAdCount:8}};var I={type:!0};function J(a){if(!a.attributes)return{};if("[object Object]"!==n.call(a.attributes)||Array.isArray(a.attributes))return q().warn("amp-auto-ads","attributes property not an object"),{};var b=a.attributes,c={},d;for(d in b)if(I[d]||(5>d.length?0:0==d.lastIndexOf("data-",0))){var e=typeof b[d];"number"!=e&&"string"!=e&&"boolean"!=e?q().warn("amp-auto-ads","Attribute type not supported: "+e):c[d]=String(b[d])}else q().warn("amp-auto-ads","Attribute not whitlisted: "+d);return c};var K=["AMP-SIDEBAR","AMP-APP-BANNER"],L={1:function(a,b){a.parentNode.insertBefore(b,a)},4:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)},2:function(a,b){a.insertBefore(b,a.firstChild)},3:function(a,b){a.appendChild(b)}};function M(a,b,c,d,e,f,h){this.F=a;this.l=b;this.i=c;this.D=d;this.A=e;this.o=f;this.B=h;this.b=null;this.a=0}M.prototype.getAdElement=function(){return this.b};
M.prototype.getEstimatedPosition=function(){var a=this;return this.l.getElementLayoutBox(this.i).then(function(b){var c;a:switch(c=b,a.D){case 1:case 2:c=c.top;break a;case 3:case 4:c=c.bottom;break a;default:throw Error("Unknown position");}return c})};
M.prototype.placeAd=function(a,b){var c=this;return this.getEstimatedPosition().then(function(d){return b.isTooNearAnAd(d).then(function(b){if(b)return c.a=3,c.a;c.b=N(c,a);c.A(c.i,c.b);return c.l.attemptChangeSize(c.b,250,void 0,c.B).then(function(){c.a=2;return c.a},function(){c.a=1;return c.a})})})};
function N(a,b){b=Object.assign({layout:"fixed-height",height:"0","class":"i-amphtml-layout-awaiting-size"},b,a.o);a=a.F.document.createElement("amp-ad");for(var c in b)a.setAttribute(c,b[c]);return a}function O(a,b){var c=b.placements;if(!c)return q().warn("amp-auto-ads","No placements in config"),[];var d=[];c.forEach(function(c){P(a,c,d)});return d}
function P(a,b,c){var d=L[b.pos];if(d){var e=b.anchor;if(e){var f=Q(a.document.documentElement,e);if(f.length){var h=void 0;if(b.style){var k=parseInt(b.style.top_m,10),l=parseInt(b.style.bot_m,10);if(k||l)h={top:k||void 0,bottom:l||void 0}}f.forEach(function(e){if(R(e,b.pos)){var f=J(b);c.push(new M(a,w(e,"resources"),e,b.pos,d,f,h))}})}else q().warn("amp-auto-ads","No anchor element found")}else q().warn("amp-auto-ads","No anchor in placement")}else q().warn("amp-auto-ads","No injector for position")}
function Q(a,b){var c=b.selector;if(!c)return q().warn("amp-auto-ads","No selector in anchor"),[];var c=[].slice.call(F(a,c)),d=b.min_c||0;0<d&&(c=c.filter(function(a){return a.textContent.length>=d}));"number"!=typeof b.index&&b.all||(c=(c=c[b.index||0])?[c]:[]);if(0==c.length)return[];if(b.sub){var e=[];c.forEach(function(a){e=e.concat(Q(a,b.sub))});return e}return c}
function R(a,b){var c=1==b||4==b?a.parentElement:a;if(!c)return q().warn("amp-auto-ads","Parentless anchor with BEFORE/AFTER position."),!1;var d=c;return!K.some(function(a){return D(d,a)?(q().warn("amp-auto-ads","Placement inside blacklisted ancestor: "+a),!0):!1})};function S(a,b,c){this.s=a.slice(0);this.u=b;this.c=c;this.h=0}S.prototype.run=function(){var a=this;return this.c.isMaxAdCountReached()?Promise.resolve(T(this)):U(this).then(function(b){return b?a.run():T(a)})};function T(a){return{adsPlaced:a.h,totalAdsOnPage:a.c.getAdCount()}}function U(a){var b=a.s.shift();return b?b.placeAd(a.u,a.c).then(function(c){return 2==c?(a.c.addAd(b.getAdElement()),a.h++,!0):U(a)}):(q().warn("amp-auto-ads","unable to fulfill ad strategy"),Promise.resolve(!1))};function V(a,b){this.f=a;this.w=b.initialMinSpacing;this.m=b.subsequentMinSpacing.slice(0).sort(function(a,b){return a.adCount-b.adCount});this.C=b.maxAdCount;this.j=W(this)}V.prototype.addAd=function(a){this.f.push(a);this.j=W(this)};V.prototype.getAdCount=function(){return this.f.length};V.prototype.isMaxAdCountReached=function(){return this.getAdCount()>=this.C};V.prototype.isTooNearAnAd=function(a){return X(this,a,0)};
function X(a,b,c){return c>=a.f.length?Promise.resolve(!1):Y(b,a.f[c]).then(function(d){return d<a.j?!0:X(a,b,c+1)})}function Y(a,b){return w(b,"resources").getElementLayoutBox(b).then(function(c){return a>=c.top&&a<=c.bottom?0:Math.min(Math.abs(a-c.top),Math.abs(a-c.bottom))})}function W(a){for(var b=a.getAdCount(),c=a.w,d=0;d<a.m.length;d++){var e=a.m[d];e.adCount<=b&&(c=e.spacing)}return c};function Z(a){AMP.BaseElement.apply(this,arguments)}g(Z,AMP.BaseElement);
Z.prototype.buildCallback=function(){var a=this;q().assert(z(self,"amp-auto-ads"),"Experiment is off");var b=this.element.getAttribute("type");q().assert(b,"Missing type attribute");var c="adsense"==b?new H(this.element):null;q().assert(c,"No AdNetworkConfig for type: "+b);c.isEnabled(this.win)&&aa(this,c.getConfigUrl()).then(function(b){if(b){var d=O(a.win,b);b=Object.assign(c.getAttributes(),J(b));var f;f=a.win;f=[].slice.call(f.document.getElementsByTagName("AMP-AD")).concat([].slice.call(f.document.getElementsByTagName("AMP-A4A")));f=
new V(f,c.getAdConstraints());(new S(d,b,f)).run()}})};Z.prototype.isLayoutSupported=function(){return!0};function aa(a,b){var c={mode:"cors",method:"GET",credentials:"omit",requireAmpResponseSourceOrigin:!1};return u(a.win,"xhr").fetchJson(b,c).then(function(a){return a.json()}).catch(function(a){q().error("amp-auto-ads","amp-auto-ads config xhr failed: "+a);return null})}AMP.registerElement("amp-auto-ads",Z);
})});
//# sourceMappingURL=amp-auto-ads-0.1.js.map

