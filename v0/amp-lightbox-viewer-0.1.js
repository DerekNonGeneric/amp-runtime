(self.AMP=self.AMP||[]).push({n:"amp-lightbox-viewer",v:"123456789",f:(function(AMP){var g;function k(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]};var l=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;Date.now();self.log=self.log||{user:null,dev:null};var m=self.log;function n(){if(m.user)return m.user;throw Error("failed to call initLogConstructor");};function p(a,b){a=a.__AMP_TOP||a;var c=a.services;c||(c=a.services={});b=c[b];b.obj||(b.obj=new b.ctor(b.context),b.ctor=null,b.context=null,b.resolve&&b.resolve(b.obj));return b.obj};var q=null;Promise.resolve();
function r(a,b){var c;if(!q){q=Object.create(null);if(a.AMP_CONFIG)for(c in a.AMP_CONFIG){var d=a.AMP_CONFIG[c];"number"===typeof d&&0<=d&&1>=d&&(q[c]=Math.random()<d)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length&&(c=a.AMP_CONFIG["allow-doc-opt-in"],d=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]')))for(var d=d.getAttribute("content").split(","),e=0;e<d.length;e++)-1!=c.indexOf(d[e])&&(q[d[e]]=!0);Object.assign(q,
t(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){c=a.AMP_CONFIG["allow-url-opt-in"];d=a.location.originalHash||a.location.hash;a=Object.create(null);if(d)for(var f;f=l.exec(d);)e=decodeURIComponent(f[1]).trim(),f=f[2]?decodeURIComponent(f[2]).trim():"",a[e]=f;for(d=0;d<c.length;d++)e=a["e-"+c[d]],"1"==e&&(q[c[d]]=!0),"0"==e&&(q[c[d]]=!1)}}c=q;var h=c;return!!h[b]}
function t(a){a:{var b;b:{try{b=a.document.cookie;break b}catch(h){}b=void 0}if(a=b)for(a=a.split(";"),b=0;b<a.length;b++){var c=a[b].trim(),d=c.indexOf("=");if(-1!=d&&"AMP_EXP"==decodeURIComponent(c.substring(0,d).trim())){a=decodeURIComponent(c.substring(d+1).trim());break a}}a=null}var e=a,f=e?e.split(/\s*,\s*/g):[];a=Object.create(null);for(b=0;b<f.length;b++)0!=f[b].length&&("-"==f[b][0]?a[f[b].substr(1)]=!1:a[f[b]]=!0);return a};function u(a,b,c){if(b(a))c();else{var d=a.ownerDocument.defaultView;if(d.MutationObserver){var e=new d.MutationObserver(function(){b(a)&&(e.disconnect(),c())});e.observe(a,{childList:!0})}else var f=d.setInterval(function(){b(a)&&(d.clearInterval(f),c())},5)}}function v(a,b){u(a.documentElement,function(){return!!a.body},b)}function w(a){return new Promise(function(b){v(a,b)})};var x,y="Webkit webkit Moz moz ms O o".split(" ");function B(a){var b=void 0;x||(x=Object.create(null));var c=x.display;if(!c||b){c="display";if(void 0===a.display){var d="D"+"display".slice(1);a:{for(var e=0;e<y.length;e++){var f=y[e]+d;if(void 0!==a[f]){d=f;break a}}d=""}var h=d;void 0!==a[h]&&(c=h)}b||(x.display=c)}return c}function C(a,b){if(void 0===b){var c;c=(c=B(a.style))?a.style[c]:void 0;b="none"==c}c=b?"":"none";var d=B(a.style);d&&(a.style[d]=c)};function D(a,b){function c(a){try{return f(a)}catch(A){throw self.reportError(A),A;}}var d=void 0,e=a,f=b,h=d||!1;e.addEventListener("click",c,h)};function E(a){return"loading"!=a.readyState&&"uninitialized"!=a.readyState}function F(a,b){var c=E,d=c(a);if(d)b(a);else{var e=function(){c(a)&&(d||(d=!0,b(a)),a.removeEventListener("readystatechange",e))};a.addEventListener("readystatechange",e)}}function G(a){return new Promise(function(b){F(a,b)})};var H="amp-img amp-anim amp-ad amp-dailymotion amp-jwplayer amp-kaltura-player amp-o2-player amp-pinterest amp-reach-player amp-vimeo amp-vine amp-youtube amp-video amp-twitter amp-facebook amp-instagram".split(" "),I={"amp-img":!0,"amp-anim":!0};
function J(a){r(a.win,"amp-lightbox-viewer");r(a.win,"amp-lightbox-viewer-auto");return K(a).then(function(b){for(var c=H.join(","),d=a.getRootNode().querySelectorAll(c),e=0;e<d.length;e++){var f=d[e],h;if(h=!f.hasAttribute("lightbox"))a:{if(f.getLayoutBox&&(h=f.getLayoutBox(),0>h.left||50>h.width||50>h.height)){h=!1;break a}h=!0}h&&(f.setAttribute("lightbox",""),f.hasAttribute("lightbox"),I[f.tagName.toLowerCase()]&&!f.hasAttribute("on")&&f.setAttribute("on","tap:"+b+".activate"))}})}
function K(a){return w(a.getRootNode()).then(function(){var b=a.getRootNode().getElementsByTagName("amp-lightbox-viewer")[0]||null;if(b)return b.id||(b.id="amp-lightbox-viewer"),b.id;var c=a.getRootNode().createElement("amp-lightbox-viewer");c.setAttribute("layout","nodisplay");c.setAttribute("id","amp-lightbox-viewer");a.getRootNode().body.appendChild(c);return c.id})};function L(a){var b=this;r(a.win,"amp-lightbox-viewer");this.j=a;this.i=this.b=null;p(a.win,"timer").delay(function(){M(b)},500)}g=L.prototype;g.getNext=function(a){var b=this;return M(this).then(function(){var c=b.b.indexOf(a);return c==b.b.length-1?null:b.b[c+1]})};g.getPrevious=function(a){var b=this;return M(this).then(function(){var c=b.b.indexOf(a);return 0==c?null:b.b[c-1]})};g.hasNext=function(a){return this.getNext(a).then(function(a){return!!a})};g.hasPrevious=function(a){return this.getPrevious(a).then(function(a){return!!a})};
function M(a){if(a.i)return a.i;r(a.j.win,"amp-lightbox-viewer-auto")?a.i=J(a.j).then(function(){return N(a)}):a.i=N(a);return a.i}function N(a){return G(a.j).then(function(){var b=a.j.getRootNode().querySelectorAll("[lightbox]");a.b=[];for(var c=0;c<b.length;c++){var d=b[c];"none"!=d.getAttribute("lightbox").toLowerCase()&&a.b.push(d)}})}g.getElements=function(){var a=this;return M(this).then(function(){return a.b})};
g.getDescription=function(a){var b=a.getAttribute("aria-describedby");if(b){var c=a.ownerDocument.getElementById(b);if(c)return c.textContent}var d=a.getAttribute("alt");return d?d:null};g.getThumbnails=function(){for(var a=[],b=0;b<this.b.length;b++){var c=this.b[b],d=b,e={url:"AMP-IMG"==c.tagName?c.getAttribute("src"):"https://placehold.it/128x128?text="+d,element:this.b[b]};a.push(e)}return a};var O;function P(a){AMP.BaseElement.apply(this,arguments)}k(P,AMP.BaseElement);g=P.prototype;g.isLayoutSupported=function(a){return"nodisplay"==a};g.renderOutsideViewport=function(){return!0};
g.buildCallback=function(){n().assert(r(this.win,"amp-lightbox-viewer"),"Experiment amp-lightbox-viewer disabled");this.m=!1;this.g=-1;this.u=this.C.bind(this);this.o=O;this.s=this.getVsync();this.a=this.win.document.createElement("div");this.a.classList.add("i-amphtml-lbv");this.f=this.c=null;this.w=[];this.l=this.h=null;var a=this.win.document.createElement("div");a.classList.add("i-amphtml-lbv-mask");this.a.appendChild(a);Q(this);this.f=this.win.document.createElement("div");this.f.classList.add("i-amphtml-lbv-desc-box");
a=this.F.bind(this);D(this.a,a);this.a.appendChild(this.f);var a=this.B.bind(this),b=this.D.bind(this),c=this.A.bind(this);R(this,"Close","amp-lbv-button-close",a);R(this,"Gallery","amp-lbv-button-gallery",b);R(this,"Content","amp-lbv-button-slide",c);this.element.appendChild(this.a)};g.layoutCallback=function(){return Promise.resolve()};
function Q(a){a.c||(p(a.win,"extensions").loadExtension("amp-carousel"),a.c=a.win.document.createElement("amp-carousel"),a.c.setAttribute("type","slides"),a.c.setAttribute("layout","fill"),a.o.getElements().then(function(b){var c=b;a.s.mutate(function(){var b=0;c.forEach(function(c){c.lightboxItemId=b++;var d=!c.classList.contains("i-amphtml-element"),e=c.cloneNode(d);e.removeAttribute("on");var z=a.o.getDescription(c);z&&(e.descriptionText=z);a.w.push(e);a.c.appendChild(e)})})}),a.a.appendChild(a.c),
a.c.addEventListener("slideChange",function(b){a.g=b.data.index;S(a)}))}function S(a){var b=a.w[a.g].descriptionText;(a.f.textContent=b)||a.f.classList.add("hide")}g.F=function(){S(this);this.f.textContent&&this.f.classList.toggle("hide")};function R(a,b,c,d){var e=a.win.document.createElement("div");e.setAttribute("role","button");e.setAttribute("aria-label",b);e.classList.add(c);e.addEventListener("click",function(a){d();a.stopPropagation()});a.a.appendChild(e)}
g.activate=function(a){var b=a.source;if(a.args&&a.args.id){var c=a.args.id,b=this.win.document.getElementById(c);n().assert(b,"amp-lightbox-viewer.open: element with id: %s not found",c)}this.getViewport().enterLightboxMode();C(this.element,!0);this.m=!0;this.updateInViewport(this.a,!0);this.scheduleLayout(this.a);this.g=b.lightboxItemId;this.c.implementation_.showSlideWhenReady(this.g);this.win.document.documentElement.addEventListener("keydown",this.u);return Promise.resolve()};
g.B=function(){if(!this.m)return Promise.resolve();C(this.element,!1);this.getViewport().leaveLightboxMode();this.schedulePause(this.a);this.m=!1;this.f.classList.remove("hide");this.a.removeAttribute("gallery-view");this.win.document.documentElement.removeEventListener("keydown",this.u)};g.C=function(a){a=a.keyCode;27==a?this.B():39==a?this.G():37==a&&this.H()};g.D=function(){this.h||T(this);this.a.setAttribute("gallery-view","")};g.A=function(){this.a.removeAttribute("gallery-view")};
function T(a){a.h=a.win.document.createElement("div");a.h.classList.add("i-amphtml-lbv-gallery");U(a);a.s.mutate(function(){a.a.appendChild(a.h)})}function U(a){a.l||(a.l=[],a.o.getThumbnails().forEach(function(b){var c=V(a,b);a.l.push(c)}),a.s.mutate(function(){a.l.forEach(function(b){a.h.appendChild(b)})}))}
function V(a,b){function c(c){a.A();a.g=b.element.lightboxItemId;S(a);a.c.implementation_.showSlideWhenReady(a.g);c.stopPropagation()}var d=a.win.document.createElement("div");d.classList.add("i-amphtml-lbv-gallery-thumbnail");var e=a.win.document.createElement("img");e.classList.add("i-amphtml-lbv-gallery-thumbnail-img");e.setAttribute("src",b.url);d.appendChild(e);d.addEventListener("click",c);return d}(function(a){r(a,"amp-lightbox-viewer")&&(a=p(a,"ampdoc").getAmpDoc(),O=new L(a))})(AMP.win);
AMP.registerElement("amp-lightbox-viewer",P,".i-amphtml-lbv{position:fixed!important;top:0!important;left:0!important;right:0!important;bottom:0!important;z-index:2147483642}.i-amphtml-lbv-gallery,.i-amphtml-lbv-mask{position:absolute!important;left:0!important;right:0!important;bottom:0!important;opacity:1!important;background-color:#000!important}.i-amphtml-lbv-mask{top:0!important}.i-amphtml-lbv-gallery{display:none;top:50px!important;overflow:auto!important}.i-amphtml-lbv-desc-box{position:absolute!important;left:0!important;right:0!important;bottom:0!important;max-height:30vh!important;padding:10px;overflow-x:hidden;overflow-y:auto;color:#fff;background-color:rgba(0,0,0,.7);opacity:1;-webkit-transition:opacity 1s;transition:opacity 1s}.i-amphtml-lbv-desc-box.hide{opacity:0}.i-amphtml-lbv[gallery-view] .i-amphtml-lbv-gallery{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-align-content:flex-start;-ms-flex-line-pack:start;align-content:flex-start}.i-amphtml-lbv-gallery-thumbnail{width:33.33333vw;height:33.33333vw;padding:5px;box-sizing:border-box;overflow:hidden}.i-amphtml-lbv-gallery-thumbnail-img{-o-object-fit:cover;object-fit:cover;width:100%;height:100%}.amp-lbv-button-close,.amp-lbv-button-gallery,.amp-lbv-button-slide{position:absolute!important;cursor:pointer;width:50px;height:50px;background-repeat:no-repeat;background-position:center center;background-color:rgba(0,0,0,.7)}.amp-lbv-button-close{top:0;left:0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' height='24' viewBox='0 0 24 24' width='24'%3E%3Cpath d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z'/%3E%3Cpath d='M0 0h24v24H0z' fill='none'/%3E%3C/svg%3E\")}.amp-lbv-button-gallery{top:0;right:0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' width='24' height='24' viewBox='0 0 24 24'%3E%3Cpath d='M20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM8 20H4v-4h4v4zm0-6H4v-4h4v4zm0-6H4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4zm6 12h-4v-4h4v4zm0-6h-4v-4h4v4zm0-6h-4V4h4v4z'/%3E%3C/svg%3E\")}.amp-lbv-button-slide{top:0;right:0;display:none;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='%23fff' width='24' height='24' viewBox='0 0 512 512'%3E%3Cpath d='M368 224c26.5 0 48-21.5 48-48s-21.5-48-48-48-48 21.5-48 48 21.5 48 48 48z'/%3E%3Cpath d='M452 64H60c-15.6 0-28 12.7-28 28.3v327.4c0 15.6 12.4 28.3 28 28.3h392c15.6 0 28-12.7 28-28.3V92.3c0-15.6-12.4-28.3-28-28.3zM348.9 261.7c-3-3.5-7.6-6.2-12.8-6.2-5.1 0-8.7 2.4-12.8 5.7L304.6 277c-3.9 2.8-7 4.7-11.5 4.7-4.3 0-8.2-1.6-11-4.1-1-.9-2.8-2.6-4.3-4.1L224 215.3c-4-4.6-10-7.5-16.7-7.5-6.7 0-12.9 3.3-16.8 7.8L64 368.2V107.7c1-6.8 6.3-11.7 13.1-11.7h357.7c6.9 0 12.5 5.1 12.9 12l.3 260.4-99.1-106.7z'/%3E%3C/svg%3E\")}.i-amphtml-lbv[gallery-view] .amp-lbv-button-gallery{display:none}.i-amphtml-lbv[gallery-view] .amp-lbv-button-slide{display:block}\n/*# sourceURL=/extensions/amp-lightbox-viewer/0.1/amp-lightbox-viewer.css*/");
})});
//# sourceMappingURL=amp-lightbox-viewer-0.1.js.map

