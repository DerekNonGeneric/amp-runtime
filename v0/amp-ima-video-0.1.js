(self.AMP=self.AMP||[]).push({n:"amp-ima-video",v:"123456789",f:(function(AMP){var h;(function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a})(this);function aa(a,b){function c(){}c.prototype=b.prototype;a.prototype=new c;a.prototype.constructor=a;for(var d in b)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(b,d);e&&Object.defineProperty(a,d,e)}else a[d]=b[d]}function ba(a,b){return b.toUpperCase()}function n(a,b){return b.length>a.length?!1:0==a.lastIndexOf(b,0)};var ca=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function q(a){var b=Object.create(null);if(!a)return b;for(var c;c=ca.exec(a);){var d=decodeURIComponent(c[1]).trim(),e=c[2]?decodeURIComponent(c[2]).trim():"";b[d]=e}return b};var r="";
function t(a){var b=a||self,c;if(b.AMP_MODE)c=b.AMP_MODE;else{c=b;if(c.context&&c.context.mode)c=c.context.mode;else{var d=q(c.location.originalHash||c.location.hash),e=q(c.location.search);r||(r=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"01123456789");c={localDev:!1,development:!("1"!=d.development&&!c.AMP_DEV_MODE),examiner:"2"==d.development,filter:d.filter,minified:!0,lite:void 0!=e.amp_lite,test:!1,log:d.log,version:"123456789",rtvVersion:r}}c=b.AMP_MODE=c}return c}
;var v=Object.prototype.toString;function y(a){if(!a)return[];for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=a[c];return b}function z(a){return"number"===typeof a&&isFinite(a)};Date.now();self.log=self.log||{user:null,dev:null};var A=self.log;function C(){if(A.user)return A.user;throw Error("failed to call initLogConstructor");};function D(a){var b=Object.create(null);a&&Object.assign(b,a);return b};var E=self.AMP_CONFIG||{},da=E.thirdPartyUrl||"https://3p.ampproject.net",ea=E.thirdPartyFrameHost||"ampproject.net",fa=E.cdnUrl||"https://cdn.ampproject.org";var H,I;
function J(a){var b;H||(H=self.document.createElement("a"),I=self.UrlCache||(self.UrlCache=Object.create(null)));var c=I[a];if(c)return c;var d=H;d.href=a;d.protocol||(d.href=d.href);var e={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname);if("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)e.port="",e.host=e.hostname;e.origin=d.origin&&
"null"!=d.origin?d.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href;var f=e,g=f;return b?g:I[a]=g}function ga(a){"string"==typeof a&&(a=J(a));var b;(b="https:"==a.protocol||"localhost"==a.hostname)||(a=a.hostname,b=a.length-10,b=0<=b&&a.indexOf(".localhost",b)==b);return b}
function K(a,b){var c;c=void 0===c?"source":c;C().assert(null!=a,"%s %s must be available",b,c);var d=a;C().assert(ga(d)||/^(\/\/)/.test(d),'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',b,c,d);return d};function L(a,b){a=a.__AMP_TOP||a;return M(a,b)}function ha(a){var b=N,c=O(a),d=P(c);a=d;var e=Q(a),f=e["video-manager"];f||(f=e["video-manager"]={obj:null,promise:null,resolve:null,context:null,ctor:null});f.ctor||f.obj||(f.ctor=b,f.context=c,f.resolve&&M(a,"video-manager"))}function R(a,b){a=O(a);a=P(a);return M(a,b)}function O(a){return a.nodeType?L((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function P(a){a=O(a);return a.isSingleDoc()?a.win:a}
function M(a,b){var c=Q(a);a=c[b];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function Q(a){var b=a.services;b||(b=a.services={});return b};var S=null;Promise.resolve();function ia(a){var b=ja(a);return!!b["amp-ima-video"]}
function ja(a){if(S)return S;S=Object.create(null);if(a.AMP_CONFIG)for(var b in a.AMP_CONFIG){var c=a.AMP_CONFIG[b];"number"===typeof c&&0<=c&&1>=c&&(S[b]=Math.random()<c)}if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-doc-opt-in"])&&0<a.AMP_CONFIG["allow-doc-opt-in"].length){var d=a.AMP_CONFIG["allow-doc-opt-in"];if(b=a.document.head.querySelector('meta[name="amp-experiments-opt-in"]')){var e=b.getAttribute("content").split(",");for(b=0;b<e.length;b++)-1!=d.indexOf(e[b])&&(S[e[b]]=!0)}}Object.assign(S,
ka(a));if(a.AMP_CONFIG&&Array.isArray(a.AMP_CONFIG["allow-url-opt-in"])&&0<a.AMP_CONFIG["allow-url-opt-in"].length){b=a.AMP_CONFIG["allow-url-opt-in"];var f=a.location.originalHash||a.location.hash;a=q(f);for(var g=0;g<b.length;g++){var k=a["e-"+b[g]];"1"==k&&(S[b[g]]=!0);"0"==k&&(S[b[g]]=!1)}}return S}
function ka(a){a:{var b;b:{try{b=a.document.cookie;break b}catch(g){}b=void 0}if(a=b)for(a=a.split(";"),b=0;b<a.length;b++){var c=a[b].trim(),d=c.indexOf("=");if(-1!=d&&"AMP_EXP"==decodeURIComponent(c.substring(0,d).trim())){a=decodeURIComponent(c.substring(d+1).trim());break a}}a=null}var e=a,f=e?e.split(/\s*,\s*/g):[];a=Object.create(null);for(b=0;b<f.length;b++)0!=f[b].length&&("-"==f[b][0]?a[f[b].substr(1)]=!1:a[f[b]]=!0);return a};function la(a){a.parentElement&&a.parentElement.removeChild(a)};function ma(a){for(var b=a.nodeName,c=0,d=0,e=a.previousElementSibling;e&&25>d&&100>c;)e.nodeName==b&&d++,c++,e=e.previousElementSibling;return 25>d&&100>c?"."+d:""};var T,na="Webkit webkit Moz moz ms O o".split(" ");function oa(a,b,c){var d;var e=a.style;if(!n(b,"--")){T||(T=D());var f=T[b];if(!f){f=b;if(void 0===e[b]){var g=b.charAt(0).toUpperCase()+b.slice(1);b:{for(var k=0;k<na.length;k++){var l=na[k]+g;if(void 0!==e[l]){g=l;break b}}g=""}void 0!==e[g]&&(f=g)}T[b]=f}b=f}b&&(a.style[b]=d?c+d:c)}function pa(a){var b={position:"fixed",top:"0",width:"0",height:"0",opacity:"0"},c;for(c in b)oa(a,c,b[c])};function qa(a,b,c){function d(a){try{return g(a)}catch(p){throw self.reportError(p),p;}}var e=void 0,f=a,g=c,k=e||!1;f.addEventListener(b,d,k);return function(){f&&f.removeEventListener(b,d,k);d=f=g=null}};function U(a,b,c){return qa(a,b,c)}function ra(a,b){var c=b,d=qa(a,"load",function(a){try{c(a)}finally{c=null,d()}});return d}function sa(a){var b,c,d=new Promise(function(b){c=ra(a,b)});d.then(c,c);b&&b(c);return d};function ta(a){a=parseFloat(a);return z(a)?a:void 0};var V={};
function ua(a,b){C().assert("ima-video","Attribute type required for <amp-ad>: %s",b);for(var c=0,d=a;d&&d!=d.parent;d=d.parent)c++;for(var c=String(c)+"-"+va(a),e=d=D(void 0),f=0;f<b.attributes.length;f++){var g=b.attributes[f];0==g.name.indexOf("data-")&&(e[g.name.substr(5).replace(/-([a-z])/g,ba)]=g.value)}if(f=b.getAttribute("json")){var k;a:{try{k=JSON.parse(f);break a}catch(La){}k=void 0}if(void 0===k)throw C().createError("Error parsing JSON in json attribute in element %s",b);for(var l in k)e[l]=k[l]}l=
d;k=Date.now();d=b.getAttribute("width");e=b.getAttribute("height");l=l?l:D(void 0);l.width=ta(d);l.height=ta(e);var p=a.location.href;"about:srcdoc"==p&&(p=a.parent.location.href);for(var B=R(b,"documentInfo").get(),F=R(b,"viewer"),d=F.getUnconfirmedReferrerUrl(),u=b.getPageLayoutBox(),e=l,f=B.sourceUrl,g=B.canonicalUrl,B=B.pageViewId,p={href:p},za=b.tagName,Aa={localDev:!1,development:t(void 0).development,filter:t(void 0).filter,minified:!0,lite:t(void 0).lite,test:!1,log:t(void 0).log,version:t(void 0).version,
rtvVersion:t(void 0).rtvVersion},Ba=!(!a.AMP_CONFIG||!a.AMP_CONFIG.canary),F=!F.isVisible(),u=u?{left:u.left,top:u.top,width:u.width,height:u.height}:null,Ca=b.getIntersectionChangeEntry(),m=b,G=[],w=0;m&&1==m.nodeType&&25>w;){var x="";m.id&&(x="/"+m.id);var Da=m.nodeName.toLowerCase();G.push(""+Da+x+ma(m));w++;m=m.parentElement}m=G.join();G=m.length;w=5381;for(x=0;x<G;x++)w=33*w^m.charCodeAt(x);e._context=D({ampcontextVersion:"123456789",ampcontextFilepath:fa+"/123456789/ampcontext-v0.js",
sourceUrl:f,referrer:d,canonicalUrl:g,pageViewId:B,location:p,startTime:k,tagName:za,mode:Aa,canary:Ba,hidden:F,initialLayoutRect:u,initialIntersection:Ca,domFingerprint:String(w>>>0),experimentToggles:ja(a),sentinel:c});(a=b.getAttribute("src"))&&(l.src=a);d=l;d.type="ima-video";Object.assign(d._context,void 0);return d}
function wa(a,b){var c=ua(a,b),d=a.document.createElement("iframe");V[c.type]||(V[c.type]=0);V[c.type]+=1;a=xa(a);var e=J(a).hostname,f=JSON.stringify(D({host:e,type:c.type,count:V[c.type],attributes:c}));d.src=a;d.ampLocation=J(a);d.name=f;c.width&&(d.width=c.width);c.height&&(d.height=c.height);d.setAttribute("scrolling","no");oa(d,"border","none");d.onload=function(){this.readyState="complete"};d.setAttribute("data-amp-3p-sentinel",c._context.sentinel);return d}
function xa(a){var b,c=a.bootstrapBaseUrl;if(c)a=c;else{var d;d=b;var e=a.document.querySelector('meta[name="amp-3p-iframe-src"]');if(e){var f=K(e.getAttribute("content"),e);C().assert(-1==f.indexOf("?"),"3p iframe url must not include query string %s in element %s.",f,e);var g=J(f);C().assert("localhost"==g.hostname&&!d||g.origin!=J(a.location.href).origin,"3p iframe url must not be on the same origin as the current document %s (%s) in element %s. See https://github.com/ampproject/amphtml/blob/master/spec/amp-iframe-origin-policy.md for details.",
f,g.origin,e);d=f+"?123456789"}else d=null;d||(d="https://d-"+va(a)+("."+ea+"/123456789/")+"frame.html");a=a.bootstrapBaseUrl=d}return a}function va(a){var b;if(a.crypto&&a.crypto.getRandomValues){var c=new Uint32Array(2);a.crypto.getRandomValues(c);b=String(c[0])+c[1]}else b=String(a.Math.random()).substr(2)+"0";return b};function N(a){this.c=a;this.b=null;this.C=!1}N.prototype.register=function(a){var b=a;b.registerAction("play",b.play.bind(b,!1),3);b.registerAction("pause",b.pause.bind(b),1);b.registerAction("mute",b.mute.bind(b),1);b.registerAction("unmute",b.unmute.bind(b),3);if(a.supportsPlatform()){this.b=this.b||[];var c=new ya(this.c,a);Ea(this,c);this.b.push(c)}};
function Ea(a,b){if(b.video.element.hasAttribute("autoplay")&&(U(b.video.element,"amp:video:visibility",function(){b.updateVisibility()}),U(b.video.element,"reloaded",function(){b.updateVisibility();b.o=!0;b.f&&b.g&&W(b)}),!a.C)){var c=function(){for(var b=0;b<a.b.length;b++)a.b[b].updateVisibility()},d=R(a.c,"viewport");d.onScroll(c);d.onChanged(c);a.C=!0}}function Fa(a,b){for(var c=0;c<a.b.length;c++)if(a.b[c].video===b)return a.b[c];return null}
N.prototype.getPlayingState=function(a){return Fa(this,a).getPlayingState()};N.prototype.userInteractedWithAutoPlay=function(a){return Fa(this,a).userInteractedWithAutoPlay()};
function ya(a,b){var c=this;this.c=a;this.video=b;this.H=null;this.f=this.h=this.o=!1;this.w=L(a.win,"vsync");this.A=Ga.bind(null,a.win,t(a.win).lite);a=b.element;this.g=a.hasAttribute("autoplay");this.B=this.m=!1;sa(a).then(function(){c.updateVisibility();c.o=!0;c.f&&c.g&&W(c)});U(this.video.element,"pause",this.F.bind(this));U(this.video.element,"play",this.G.bind(this));this.updateVisibility();this.g&&Ha(this)}h=ya.prototype;h.G=function(){this.h=!0};h.F=function(){this.h=!1};
function Ha(a){a.video.isInteractive()&&a.video.hideControls();a.A().then(function(b){!b&&a.video.isInteractive()?a.video.showControls():(a.video.mute(),a.video.isInteractive()&&Ia(a))})}
function Ia(a){function b(b){a.w.mutate(function(){d.classList.toggle("amp-video-eq-play",b)})}function c(){this.m=!0;this.video.showControls();this.video.unmute();f();g();k();d.remove();e.remove()}a.video.hideControls();var d=Ja(a),e=Ka(a);a.w.mutate(function(){a.video.element.appendChild(d);a.video.element.appendChild(e)});var f=U(e,"click",c.bind(a)),g=U(a.video.element,"pause",b.bind(a,!1)),k=U(a.video.element,"play",b.bind(a,!0))}
function W(a){!a.m&&R(a.c,"viewer").isVisible()&&a.A().then(function(b){b&&(a.f?(a.video.play(!0),a.B=!0):a.video.pause())})}
function Ja(a){var b=a.c.win.document,c=b.createElement("i-amphtml-video-eq");c.classList.add("amp-video-eq");for(var d=1;4>=d;d++){var e=b.createElement("div");e.classList.add("amp-video-eq-col");for(var f=1;2>=f;f++){var g=b.createElement("div");g.classList.add("amp-video-eq-"+d+"-"+f);e.appendChild(g)}c.appendChild(e)}var k=L(a.c.win,"platform");k.isIos()&&c.setAttribute("unpausable","");return c}
function Ka(a){a=a.c.win.document.createElement("i-amphtml-video-mask");a.classList.add("i-amphtml-fill-content");return a}h.updateVisibility=function(){function a(){c.f!=d&&c.o&&c.g&&W(c)}function b(){if(c.video.isInViewport()){var a=c.video.element.getIntersectionChangeEntry(),b=z(a.intersectionRatio)?100*a.intersectionRatio:0;c.f=75<=b}else c.f=!1}var c=this,d=this.f;this.w.run({measure:b,mutate:a})};
h.getPlayingState=function(){return this.h?this.h&&this.B&&!this.m?"playing_auto":"playing_manual":"paused"};h.userInteractedWithAutoPlay=function(){return this.m};var X=null;
function Ga(a,b){if(X)return X;if(b)return X=Promise.resolve(!1);var c=a.document.createElement("video");c.setAttribute("muted","");c.setAttribute("playsinline","");c.setAttribute("webkit-playsinline","");c.muted=!0;c.playsinline=!0;c.webkitPlaysinline=!0;c.setAttribute("height","0");c.setAttribute("width","0");pa(c);try{var d=c.play();d&&d.catch&&d.catch(function(){})}catch(e){}return X=Promise.resolve(!c.paused)};function Y(a){AMP.BaseElement.call(this,a);this.l=this.j=this.u=this.s=this.i=this.a=null}aa(Y,AMP.BaseElement);h=Y.prototype;
h.buildCallback=function(){var a=this;C().assert(ia(this.win),"Experiment amp-ima-video is disabled.");K(this.element.getAttribute("data-tag"),"The data-tag attribute is required for <amp-video-ima> and must be https");var b=this.element.getElementsByTagName("source"),c=this.element.getElementsByTagName("track"),d=y(b).concat(y(c));if(0<d.length){var e=[];d.forEach(function(b){"SOURCE"!=b.tagName||a.j?"TRACK"!=b.tagName||a.l||(a.l=b.src):a.j=b.src;e.push(b.outerHTML)});this.element.setAttribute("data-child-elements",
JSON.stringify(e))}};h.preconnectCallback=function(){this.preconnect.preload("https://imasdk.googleapis.com/js/sdkloader/ima3.js","script");var a=this.element.getAttribute("data-src");a&&this.preconnect.url(a);this.j&&this.preconnect.url(this.j);this.l&&this.preconnect.url(this.l);this.preconnect.url(this.element.getAttribute("data-tag"));var a=this.preconnect,b=xa(this.win);a.preload(b,"document");a.preload(da+"/123456789/f.js","script")};
h.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a};h.layoutCallback=function(){var a=this,b=wa(this.element.ownerDocument.defaultView,this.element);b.setAttribute("allowfullscreen","true");this.applyFillContent(b);this.a=b;this.i=new Promise(function(b){a.s=b});this.u=U(this.win,"message",this.D.bind(this));this.element.appendChild(b);ha(this.element);R(this.win.document,"video-manager").register(this);return this.loadPromise(b).then(function(){return a.i})};
h.viewportCallback=function(a){this.element.dispatchCustomEvent("amp:video:visibility",{visible:a})};h.unlayoutCallback=function(){var a=this;this.a&&(la(this.a),this.a=null);this.u&&this.u();this.i=new Promise(function(b){a.s=b});return!0};h.onLayoutMeasure=function(){this.a&&Z(this,"resize",{width:this.a.offsetWidth,height:this.a.offsetHeight})};
function Z(a,b,c){a.a&&a.a.contentWindow&&a.i.then(function(){a.a.contentWindow.postMessage(JSON.stringify(D({event:"command",func:b,args:c||""})),"*")})}h.D=function(a){a.source!=this.a.contentWindow||!a.data||"[object Object]"!==v.call(a.data)&&!n(a.data,"{")||"[object Object]"!==v.call(a.data)||"load"!=a.data.event&&"play"!=a.data.event&&"pause"!=a.data.event&&"muted"!=a.data.event&&"unmuted"!=a.data.event||("load"==a.data.event&&this.s(this.a),this.element.dispatchCustomEvent(a.data.event))};
h.supportsPlatform=function(){return!0};h.isInteractive=function(){return!0};h.play=function(){Z(this,"playVideo")};h.pause=function(){Z(this,"pauseVideo")};h.mute=function(){Z(this,"mute")};h.unmute=function(){Z(this,"unMute")};h.showControls=function(){};h.hideControls=function(){};AMP.registerElement("amp-ima-video",Y);
})});
//# sourceMappingURL=amp-ima-video-0.1.js.map

