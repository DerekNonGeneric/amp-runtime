(self.AMP=self.AMP||[]).push({n:"amp-brid-player",v:"123456789",f:(function(AMP){var g;(function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a})(this);function m(a,c){function b(){}b.prototype=c.prototype;a.prototype=new b;a.prototype.constructor=a;for(var d in c)if(Object.defineProperties){var e=Object.getOwnPropertyDescriptor(c,d);e&&Object.defineProperty(a,d,e)}else a[d]=c[d]};var p=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function q(a){var c=Object.create(null);if(!a)return c;for(var b;b=p.exec(a);){var d=decodeURIComponent(b[1]).trim(),e=b[2]?decodeURIComponent(b[2]).trim():"";c[d]=e}return c};var r="";
function t(a){var c=a||self,b;if(c.AMP_MODE)b=c.AMP_MODE;else{b=c;if(b.context&&b.context.mode)b=b.context.mode;else{var d=q(b.location.originalHash||b.location.hash),e=q(b.location.search);r||(r=b.AMP_CONFIG&&b.AMP_CONFIG.v?b.AMP_CONFIG.v:"01123456789");b={localDev:!1,development:!("1"!=d.development&&!b.AMP_DEV_MODE),examiner:"2"==d.development,filter:d.filter,minified:!0,lite:void 0!=e.amp_lite,test:!1,log:d.log,version:"123456789",rtvVersion:r}}b=c.AMP_MODE=b}return b}
;Date.now();self.log=self.log||{user:null,dev:null};var u=self.log;function v(){if(u.user)return u.user;throw Error("failed to call initLogConstructor");};var w,x;function y(a,c){a=a.__AMP_TOP||a;return z(a,c)}function A(a){var c=B,b=C(a),d=D(b);a=d;var e=E(a),f=e["video-manager"];f||(f=e["video-manager"]={obj:null,promise:null,resolve:null,context:null,ctor:null});f.ctor||f.obj||(f.ctor=c,f.context=b,f.resolve&&z(a,"video-manager"))}function F(a,c){a=C(a);a=D(a);return z(a,c)}function C(a){return a.nodeType?y((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function D(a){a=C(a);return a.isSingleDoc()?a.win:a}
function z(a,c){var b=E(a);a=b[c];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function E(a){var c=a.services;c||(c=a.services={});return c};function G(a){a.parentElement&&a.parentElement.removeChild(a)};var H,I="Webkit webkit Moz moz ms O o".split(" ");function K(a){var c={position:"fixed",top:"0",width:"0",height:"0",opacity:"0"},b;for(b in c){var d=a,e=c[b],f;f=d.style;var h=b;if(2>h.length?0:0==h.lastIndexOf("--",0))f=h;else{H||(H=Object.create(null));var k=H[h];if(!k){k=h;if(void 0===f[h]){var l;l=h;l=l.charAt(0).toUpperCase()+l.slice(1);b:{for(var n=0;n<I.length;n++){var J=I[n]+l;if(void 0!==f[J]){l=J;break b}}l=""}void 0!==f[l]&&(k=l)}H[h]=k}f=k}f&&(d.style[f]=e)}};function L(a,c,b){function d(a){try{return h(a)}catch(n){throw self.reportError(n),n;}}var e=void 0,f=a,h=b,k=e||!1;f.addEventListener(c,d,k);return function(){f&&f.removeEventListener(c,d,k);d=f=h=null}};function M(a,c,b){return L(a,c,b)}function N(a,c){var b=c,d=L(a,"load",function(a){try{b(a)}finally{b=null,d()}});return d}function O(a){var c,b,d=new Promise(function(c){b=N(a,c)});d.then(b,b);c&&c(b);return d};function B(a){this.c=a;this.b=null;this.F=!1}B.prototype.register=function(a){var c=a;c.registerAction("play",c.play.bind(c,!1),3);c.registerAction("pause",c.pause.bind(c),1);c.registerAction("mute",c.mute.bind(c),1);c.registerAction("unmute",c.unmute.bind(c),3);if(a.supportsPlatform()){this.b=this.b||[];var b=new P(this.c,a);Q(this,b);this.b.push(b)}};
function Q(a,c){if(c.video.element.hasAttribute("autoplay")&&(M(c.video.element,"amp:video:visibility",function(){c.updateVisibility()}),M(c.video.element,"reloaded",function(){c.updateVisibility();c.o=!0;c.f&&c.g&&R(c)}),!a.F)){var b=function(){for(var b=0;b<a.b.length;b++)a.b[b].updateVisibility()},d=F(a.c,"viewport");d.onScroll(b);d.onChanged(b);a.F=!0}}function S(a,c){for(var b=0;b<a.b.length;b++)if(a.b[b].video===c)return a.b[b];return null}
B.prototype.getPlayingState=function(a){return S(this,a).getPlayingState()};B.prototype.userInteractedWithAutoPlay=function(a){return S(this,a).userInteractedWithAutoPlay()};
function P(a,c){var b=this;this.c=a;this.video=c;this.K=null;this.f=this.h=this.o=!1;this.A=y(a.win,"vsync");this.B=T.bind(null,a.win,t(a.win).lite);a=c.element;this.g=a.hasAttribute("autoplay");this.C=this.j=!1;O(a).then(function(){b.updateVisibility();b.o=!0;b.f&&b.g&&R(b)});M(this.video.element,"pause",this.I.bind(this));M(this.video.element,"play",this.J.bind(this));this.updateVisibility();this.g&&U(this)}g=P.prototype;g.J=function(){this.h=!0};g.I=function(){this.h=!1};
function U(a){a.video.isInteractive()&&a.video.hideControls();a.B().then(function(c){!c&&a.video.isInteractive()?a.video.showControls():(a.video.mute(),a.video.isInteractive()&&V(a))})}
function V(a){function c(b){a.A.mutate(function(){d.classList.toggle("amp-video-eq-play",b)})}function b(){this.j=!0;this.video.showControls();this.video.unmute();f();h();k();d.remove();e.remove()}a.video.hideControls();var d=W(a),e=aa(a);a.A.mutate(function(){a.video.element.appendChild(d);a.video.element.appendChild(e)});var f=M(e,"click",b.bind(a)),h=M(a.video.element,"pause",c.bind(a,!1)),k=M(a.video.element,"play",c.bind(a,!0))}
function R(a){!a.j&&F(a.c,"viewer").isVisible()&&a.B().then(function(c){c&&(a.f?(a.video.play(!0),a.C=!0):a.video.pause())})}
function W(a){var c=a.c.win.document,b=c.createElement("i-amphtml-video-eq");b.classList.add("amp-video-eq");for(var d=1;4>=d;d++){var e=c.createElement("div");e.classList.add("amp-video-eq-col");for(var f=1;2>=f;f++){var h=c.createElement("div");h.classList.add("amp-video-eq-"+d+"-"+f);e.appendChild(h)}b.appendChild(e)}var k=y(a.c.win,"platform");k.isIos()&&b.setAttribute("unpausable","");return b}
function aa(a){a=a.c.win.document.createElement("i-amphtml-video-mask");a.classList.add("i-amphtml-fill-content");return a}g.updateVisibility=function(){function a(){b.f!=d&&b.o&&b.g&&R(b)}function c(){if(b.video.isInViewport()){var a=b.video.element.getIntersectionChangeEntry(),c=a.intersectionRatio,d="number"===typeof c&&isFinite(c)?100*a.intersectionRatio:0;b.f=75<=d}else b.f=!1}var b=this,d=this.f;this.A.run({measure:c,mutate:a})};
g.getPlayingState=function(){return this.h?this.h&&this.C&&!this.j?"playing_auto":"playing_manual":"paused"};g.userInteractedWithAutoPlay=function(){return this.j};var X=null;
function T(a,c){if(X)return X;if(c)return X=Promise.resolve(!1);var b=a.document.createElement("video");b.setAttribute("muted","");b.setAttribute("playsinline","");b.setAttribute("webkit-playsinline","");b.muted=!0;b.playsinline=!0;b.webkitPlaysinline=!0;b.setAttribute("height","0");b.setAttribute("width","0");K(b);try{var d=b.play();d&&d.catch&&d.catch(function(){})}catch(e){}return X=Promise.resolve(!b.paused)};function Y(a){AMP.BaseElement.call(this,a);this.D=this.m=this.s="";this.w=this.G=this.l=this.u=this.i=this.a=null}m(Y,AMP.BaseElement);g=Y.prototype;g.preconnectCallback=function(a){this.preconnect.url("https://services.brid.tv",a);this.preconnect.url("https://cdn.brid.tv",a)};g.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a};
function ba(a){if(a.l)return a.l;var c="";a.element.hasAttribute("data-video")?c="video":a.element.hasAttribute("data-playlist")&&(c="playlist");var b="https://services.brid.tv/services/iframe/"+encodeURIComponent(c)+"/"+encodeURIComponent(a.m)+"/"+encodeURIComponent(a.s)+"/"+encodeURIComponent(a.D)+"/0/1";v().assert(/^https?\:/i.test(b),'URL must start with "http://" or "https://". Invalid value: %s',b);w||(w=self.document.createElement("a"),x=self.UrlCache||(self.UrlCache=Object.create(null)));
var d=x[b];if(d)b=d;else{d=w;d.href=b;d.protocol||(d.href=d.href);var e={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==e.pathname[0]&&(e.pathname="/"+e.pathname);if("http:"==e.protocol&&80==e.port||"https:"==e.protocol&&443==e.port)e.port="",e.host=e.hostname;e.origin=d.origin&&"null"!=d.origin?d.origin:"data:"!=e.protocol&&e.host?e.protocol+"//"+e.host:e.href;b=x[b]=e}a.l=b.href;return a.l}
g.buildCallback=function(){var a=this;this.s=v().assert(this.element.getAttribute("data-partner"),"The data-partner attribute is required for <amp-brid-player> %s",this.element);this.D=v().assert(this.element.getAttribute("data-player"),"The data-player attribute is required for <amp-brid-player> %s",this.element);this.m=v().assert(this.element.getAttribute("data-video")||this.element.getAttribute("data-playlist"),"Either the data-video or the data-playlist attributes must be specified for <amp-brid-player> %s",
this.element);this.i=new Promise(function(c){a.u=c});A(this.element);F(this.element,"video-manager").register(this)};g.layoutCallback=function(){var a=this,c=this.element.ownerDocument.createElement("iframe");c.setAttribute("frameborder","0");c.setAttribute("allowfullscreen","true");c.src=ba(this);this.applyFillContent(c);this.a=c;this.w=M(this.win,"message",this.H.bind(this));this.element.appendChild(c);return this.loadPromise(c).then(function(){return a.i})};
g.unlayoutCallback=function(){var a=this;this.a&&(G(this.a),this.a=null);this.w&&this.w();this.i=new Promise(function(c){a.u=c});return!0};g.pauseCallback=function(){this.pause()};
g.createPlaceholderCallback=function(){var a=this.win.document.createElement("amp-img"),c=this.s,b=this.m,d=this.win.document.createElement("amp-img");d.setAttribute("src","https://cdn.brid.tv/live/default/defaultSnapshot.png");d.setAttribute("referrerpolicy","origin");d.setAttribute("layout","fill");d.setAttribute("fallback","");a.appendChild(d);a.setAttribute("src","https://cdn.brid.tv/live/partners/"+encodeURIComponent(c)+"/snapshot/"+encodeURIComponent(b)+".jpg");a.setAttribute("layout","fill");
a.setAttribute("placeholder","");a.setAttribute("referrerpolicy","origin");this.applyFillContent(a);return a};function Z(a,c,b){a.i.then(function(){if(a.a&&a.a.contentWindow){var d=void 0===b?"":"|"+b;a.a.contentWindow.postMessage("Brid|"+c+d,"*")}})}
g.H=function(a){"https://services.brid.tv"===a.origin&&a.source==this.a.contentWindow&&"string"===typeof a.data&&0===a.data.indexOf("Brid")&&(a=a.data.split("|"),"trigger"==a[2]?"ready"==a[3]?(this.element.dispatchCustomEvent("load"),this.u(this.a)):"play"==a[3]?this.element.dispatchCustomEvent("play"):"pause"==a[3]&&this.element.dispatchCustomEvent("pause"):"volume"==a[2]&&(this.G=parseFloat(a[3]),0==this.G?this.element.dispatchCustomEvent("muted"):this.element.dispatchCustomEvent("unmuted")))};
g.supportsPlatform=function(){return!0};g.isInteractive=function(){return!0};g.play=function(){Z(this,"play")};g.pause=function(){Z(this,"pause")};g.mute=function(){Z(this,"muted",1);Z(this,"volume",0)};g.unmute=function(){Z(this,"muted",0);Z(this,"volume",1)};g.showControls=function(){};g.hideControls=function(){};AMP.registerElement("amp-brid-player",Y);
})});
//# sourceMappingURL=amp-brid-player-0.1.js.map

