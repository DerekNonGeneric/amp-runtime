(self.AMP=self.AMP||[]).push({n:"amp-ooyala-player",v:"123456789",f:(function(AMP){var g;(function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global?global:a})(this);function m(a,c){function b(){}b.prototype=c.prototype;a.prototype=new b;a.prototype.constructor=a;for(var d in c)if(Object.defineProperties){var f=Object.getOwnPropertyDescriptor(c,d);f&&Object.defineProperty(a,d,f)}else a[d]=c[d]};var p=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function q(a){var c=Object.create(null);if(!a)return c;for(var b;b=p.exec(a);){var d=decodeURIComponent(b[1]).trim(),f=b[2]?decodeURIComponent(b[2]).trim():"";c[d]=f}return c};var r="";
function t(a){var c=a||self,b;if(c.AMP_MODE)b=c.AMP_MODE;else{b=c;if(b.context&&b.context.mode)b=b.context.mode;else{var d=q(b.location.originalHash||b.location.hash),f=q(b.location.search);r||(r=b.AMP_CONFIG&&b.AMP_CONFIG.v?b.AMP_CONFIG.v:"01123456789");b={localDev:!1,development:!("1"!=d.development&&!b.AMP_DEV_MODE),examiner:"2"==d.development,filter:d.filter,minified:!0,lite:void 0!=f.amp_lite,test:!1,log:d.log,version:"123456789",rtvVersion:r}}b=c.AMP_MODE=b}return b}
;var u=Object.prototype.toString;Date.now();self.log=self.log||{user:null,dev:null};var v=self.log;function w(){if(v.user)return v.user;throw Error("failed to call initLogConstructor");};function x(a,c){a=a.__AMP_TOP||a;return y(a,c)}function z(a){var c=A,b=B(a),d=C(b);a=d;var f=D(a),e=f["video-manager"];e||(e=f["video-manager"]={obj:null,promise:null,resolve:null,context:null,ctor:null});e.ctor||e.obj||(e.ctor=c,e.context=b,e.resolve&&y(a,"video-manager"))}function E(a,c){a=B(a);a=C(a);return y(a,c)}function B(a){return a.nodeType?x((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function C(a){a=B(a);return a.isSingleDoc()?a.win:a}
function y(a,c){var b=D(a);a=b[c];a.obj||(a.obj=new a.ctor(a.context),a.ctor=null,a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function D(a){var c=a.services;c||(c=a.services={});return c};function F(a){a.parentElement&&a.parentElement.removeChild(a)};var G,I="Webkit webkit Moz moz ms O o".split(" ");function J(a){var c={position:"fixed",top:"0",width:"0",height:"0",opacity:"0"},b;for(b in c){var d=a,f=c[b],e;e=d.style;var h=b;if(2>h.length?0:0==h.lastIndexOf("--",0))e=h;else{G||(G=Object.create(null));var k=G[h];if(!k){k=h;if(void 0===e[h]){var l;l=h;l=l.charAt(0).toUpperCase()+l.slice(1);b:{for(var n=0;n<I.length;n++){var H=I[n]+l;if(void 0!==e[H]){l=H;break b}}l=""}void 0!==e[l]&&(k=l)}G[h]=k}e=k}e&&(d.style[e]=f)}};function K(a,c,b){function d(a){try{return h(a)}catch(n){throw self.reportError(n),n;}}var f=void 0,e=a,h=b,k=f||!1;e.addEventListener(c,d,k);return function(){e&&e.removeEventListener(c,d,k);d=e=h=null}};function L(a,c,b){return K(a,c,b)}function M(a,c){var b=c,d=K(a,"load",function(a){try{b(a)}finally{b=null,d()}});return d}function N(a){var c,b,d=new Promise(function(c){b=M(a,c)});d.then(b,b);c&&c(b);return d};function A(a){this.c=a;this.b=null;this.A=!1}A.prototype.register=function(a){var c=a;c.registerAction("play",c.play.bind(c,!1),3);c.registerAction("pause",c.pause.bind(c),1);c.registerAction("mute",c.mute.bind(c),1);c.registerAction("unmute",c.unmute.bind(c),3);if(a.supportsPlatform()){this.b=this.b||[];var b=new O(this.c,a);P(this,b);this.b.push(b)}};
function P(a,c){if(c.video.element.hasAttribute("autoplay")&&(L(c.video.element,"amp:video:visibility",function(){c.updateVisibility()}),L(c.video.element,"reloaded",function(){c.updateVisibility();c.j=!0;c.f&&c.g&&Q(c)}),!a.A)){var b=function(){for(var b=0;b<a.b.length;b++)a.b[b].updateVisibility()},d=E(a.c,"viewport");d.onScroll(b);d.onChanged(b);a.A=!0}}function R(a,c){for(var b=0;b<a.b.length;b++)if(a.b[b].video===c)return a.b[b];return null}
A.prototype.getPlayingState=function(a){return R(this,a).getPlayingState()};A.prototype.userInteractedWithAutoPlay=function(a){return R(this,a).userInteractedWithAutoPlay()};
function O(a,c){var b=this;this.c=a;this.video=c;this.D=null;this.f=this.h=this.j=!1;this.s=x(a.win,"vsync");this.u=S.bind(null,a.win,t(a.win).lite);a=c.element;this.g=a.hasAttribute("autoplay");this.w=this.i=!1;N(a).then(function(){b.updateVisibility();b.j=!0;b.f&&b.g&&Q(b)});L(this.video.element,"pause",this.B.bind(this));L(this.video.element,"play",this.C.bind(this));this.updateVisibility();this.g&&T(this)}g=O.prototype;g.C=function(){this.h=!0};g.B=function(){this.h=!1};
function T(a){a.video.isInteractive()&&a.video.hideControls();a.u().then(function(c){!c&&a.video.isInteractive()?a.video.showControls():(a.video.mute(),a.video.isInteractive()&&U(a))})}
function U(a){function c(b){a.s.mutate(function(){d.classList.toggle("amp-video-eq-play",b)})}function b(){this.i=!0;this.video.showControls();this.video.unmute();e();h();k();d.remove();f.remove()}a.video.hideControls();var d=V(a),f=W(a);a.s.mutate(function(){a.video.element.appendChild(d);a.video.element.appendChild(f)});var e=L(f,"click",b.bind(a)),h=L(a.video.element,"pause",c.bind(a,!1)),k=L(a.video.element,"play",c.bind(a,!0))}
function Q(a){!a.i&&E(a.c,"viewer").isVisible()&&a.u().then(function(c){c&&(a.f?(a.video.play(!0),a.w=!0):a.video.pause())})}
function V(a){var c=a.c.win.document,b=c.createElement("i-amphtml-video-eq");b.classList.add("amp-video-eq");for(var d=1;4>=d;d++){var f=c.createElement("div");f.classList.add("amp-video-eq-col");for(var e=1;2>=e;e++){var h=c.createElement("div");h.classList.add("amp-video-eq-"+d+"-"+e);f.appendChild(h)}b.appendChild(f)}var k=x(a.c.win,"platform");k.isIos()&&b.setAttribute("unpausable","");return b}
function W(a){a=a.c.win.document.createElement("i-amphtml-video-mask");a.classList.add("i-amphtml-fill-content");return a}g.updateVisibility=function(){function a(){b.f!=d&&b.j&&b.g&&Q(b)}function c(){if(b.video.isInViewport()){var a=b.video.element.getIntersectionChangeEntry(),c=a.intersectionRatio,d="number"===typeof c&&isFinite(c)?100*a.intersectionRatio:0;b.f=75<=d}else b.f=!1}var b=this,d=this.f;this.s.run({measure:c,mutate:a})};
g.getPlayingState=function(){return this.h?this.h&&this.w&&!this.i?"playing_auto":"playing_manual":"paused"};g.userInteractedWithAutoPlay=function(){return this.i};var X=null;
function S(a,c){if(X)return X;if(c)return X=Promise.resolve(!1);var b=a.document.createElement("video");b.setAttribute("muted","");b.setAttribute("playsinline","");b.setAttribute("webkit-playsinline","");b.muted=!0;b.playsinline=!0;b.webkitPlaysinline=!0;b.setAttribute("height","0");b.setAttribute("width","0");J(b);try{var d=b.play();d&&d.catch&&d.catch(function(){})}catch(f){}return X=Promise.resolve(!b.paused)};function Y(a){AMP.BaseElement.call(this,a);this.o=this.m=this.l=this.a=null}m(Y,AMP.BaseElement);g=Y.prototype;g.preconnectCallback=function(a){this.preconnect.url("https://player.ooyala.com",a)};g.buildCallback=function(){var a=this;this.l=new Promise(function(c){a.m=c});z(this.element);E(this.element,"video-manager").register(this)};
g.layoutCallback=function(){var a=this,c=w().assert(this.element.getAttribute("data-embedcode"),"The data-embedcode attribute is required for <amp-ooyala-player> %s",this.element),b=w().assert(this.element.getAttribute("data-pcode"),"The data-pcode attribute is required for <amp-ooyala-player> %s",this.element),d=w().assert(this.element.getAttribute("data-playerid"),"The data-playerid attribute is required for <amp-ooyala-player> %s",this.element),f="https://player.ooyala.com/iframe.html?platform=html5-priority",
e=this.element.getAttribute("data-playerversion")||"";if("v4"==e.toLowerCase()){var f="https://player.ooyala.com/static/v4/sandbox/amp_iframe/skin-plugin/amp_iframe.html?pcode="+encodeURIComponent(b),h=this.element.getAttribute("data-config");h&&(f+="&options[skin.config]="+encodeURIComponent(h))}var f=f+("&ec="+encodeURIComponent(c)+"&pbid="+encodeURIComponent(d)),k=this.element.ownerDocument.createElement("iframe");this.applyFillContent(k,!0);k.setAttribute("frameborder","0");k.setAttribute("allowfullscreen",
"true");k.src=f;this.a=k;this.o=L(this.win,"message",function(b){var c;if("[object Object]"===u.call(b.data))c=b.data;else a:{try{c=JSON.parse(b.data);break a}catch(aa){}c=void 0}b=c;void 0!==b&&("playing"==b.data?a.element.dispatchCustomEvent("play"):"paused"==b.data?a.element.dispatchCustomEvent("pause"):"muted"==b.data?a.element.dispatchCustomEvent("mute"):"unmuted"==b.data&&a.element.dispatchCustomEvent("unmute"))});this.element.appendChild(this.a);var l=this.loadPromise(this.a).then(function(){a.element.dispatchCustomEvent("load")});
this.m(l);return l};g.unlayoutCallback=function(){var a=this;this.a&&(F(this.a),this.a=null);this.o&&this.o();this.l=new Promise(function(c){a.m=c});return!0};g.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a};g.viewportCallback=function(a){this.element.dispatchCustomEvent("amp:video:visibility",{visible:a})};g.pauseCallback=function(){this.a&&this.pause()};
function Z(a,c){a.l.then(function(){a.a&&a.a.contentWindow&&a.a.contentWindow.postMessage(c,"*")})}g.play=function(){Z(this,"play")};g.pause=function(){Z(this,"pause")};g.mute=function(){Z(this,"mute")};g.unmute=function(){Z(this,"unmute")};g.supportsPlatform=function(){return!0};g.isInteractive=function(){return!0};g.showControls=function(){};g.hideControls=function(){};AMP.registerElement("amp-ooyala-player",Y);
})});
//# sourceMappingURL=amp-ooyala-player-0.1.js.map

